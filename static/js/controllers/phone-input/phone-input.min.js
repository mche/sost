(function(){"use strict";var app=angular.module("phone.input",[]);var re={tel:/(\d{1,3})(\d{1,3})?(\d{1,2})?(\d{1,2})?/,non_digit:/[^0-9]/g};app.directive("phoneInput",function($filter,$browser){return{require:"ngModel",link:function($scope,$element,$attrs,ngModelCtrl){var listener=function(){var value=$element.val().replace(re.non_digit,"");$element.val($filter("tel")(value,false))};ngModelCtrl.$parsers.push(function(viewValue){return viewValue.replace(re.non_digit,"").slice(0,10)});ngModelCtrl.$render=function(){$element.val($filter("tel")(ngModelCtrl.$viewValue,false))};$element.bind("change",listener);$element.bind("keydown",function(event){var key=event.keyCode;if(key==91||15<key&&key<19||37<=key&&key<=40){return}$browser.defer(listener)});$element.bind("paste cut",function(){$browser.defer(listener)})}}});app.filter("tel",function(){return function(tel){if(!tel){return""}var value=tel.toString().replace(re.non_digit,"").slice(0,10);var nums=value.match(re.tel);var fmt="("+nums[1];if(nums[2])fmt=fmt+") "+nums[2];if(nums[3])fmt=fmt+"-"+nums[3];if(nums[4])fmt=fmt+"-"+nums[4];return fmt}})})();
