(function(){"use strict";angular.module("load.templateCache",[]).service("loadTemplateCache",function($http,$templateCache){this.put=function(conf,done){done=done||"ready";Object.keys(conf).map(function(key,index){var url=conf[key];$http.get(url,{cache:true}).then(function(resp){$templateCache.put(key,resp.data);delete conf[key];if(Object.keys(conf).length==0)conf[done]=true})})};var re={mojo:/^@@@\s*(.+)/gm};this.split=function(arr,done){done=done||"ready";arr.map(function(url,index){$http.get(url,{cache:true}).then(function(resp){var splt=resp.data.split(re.mojo);while(splt.length>0){var id=splt.shift();if(id=="")continue;var tpl=splt.shift();$templateCache.put(id,tpl)}var idx=arr.indexOf(url);delete arr[idx];if(arr.join("")=="")arr.unshift(done)})})}})})();
