@@@ tmc/form/lib
<!-- Форма закупки и перемещения -->

<!--div ng-hide="$c.ready" ng-include=" 'progress/load' "></div-->
<div ng-if="$c.ready">
<!---div class="fs8">{{ $c.param | json }}</div--->
    <div ng-hide="$c.data" class="open-btn" ng-class="{'absolute animated slideInRight': !$c['кнопка открытия формы'] || $c['кнопка открытия формы'] == 'absolute', 'fixed animated fadeIn': $c['кнопка открытия формы'] == 'fixed', }" style="z-index:1; top:4rem; right:0">
      <span ng-hide="$c.param['закупка'] || $c.param['перемещение']" class="chip red-text-darken-3 border">Новое перемещение делать из вкладки 'Наличие ТМЦ'</span>
      <a ng-show="$c.param['закупка'] " class="btn-flat z-depth-1 green lighten-3 green-text text-darken-4" ng-click="$c.Open()" href="javascript:" >
        <svg  xmlns="http://www.w3.org/2000/svg" viewBox="0 0 64 64" class="green-fill fill-darken-4" style="height: 1.5rem;" ><use xlink:href="/fonts/icons.svg#form-add" /></svg>
        <span>Новая закупка ТМЦ</span>
        <sup ng-if=" $c.__data && $c.__data['@позиции тмц'] " class="chip">{{ $c.__data['@позиции тмц'].length }}</sup>
      </a>
      <a ng-show="!$c.param['закупка'] && $c.param['перемещение'] " class="btn-flat z-depth-1 red lighten-3 red-text text-darken-4" ng-click="$c.Open()" href="javascript:">
        <svg  xmlns="http://www.w3.org/2000/svg" viewBox="0 0 64 64" class=" red-fill fill-darken-4" style="height: 1.5rem;" ><use xlink:href="/fonts/icons.svg#form-add" /></svg>
        <span>Новое перемещение ТМЦ</span>
        <sup ng-if=" $c.__data && $c.__data['@позиции тмц'] " class="chip">{{ $c.__data['@позиции тмц'].length }}</sup>
      </a>
    </div>
    
    <div ng-if="$c.data"  class="card animated zoomIn"  ng-class="{'red lighten-3': $c.data['перемещение'], 'green lighten-5': !$c.data['перемещение'] && !($c.data['$на объект'] && $c.data['$на объект'].id), 'navy lighten-5': $c.data['$на объект'] && $c.data['$на объект'].id, 'modal': $c.param.modal} "  data-overlay-in="animated fade-in-05" data-overlay-out="animated  fade-out-05 " data-modal-in="animated zoomIn" data-modal-out="animated slideOutUp fast" data-dismissible="false" ng-style="$c.param.modal ? {width:'97%', 'max-height': '92%', 'top': '5%',} : {}">
      
    <div class="card-content">

      <a ng-click="$c.Cancel($event)" href="javascript:" class="right btn-flat z-depth-1 white shadow-inset-10-000 red-text">
        <svg  xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="red-fill fill-lighten-3" style="height: 1.5rem;" ><use xlink:href="/fonts/icons.svg#cancel" /></svg>
        <span>Отмена</span>
      </a>
      
      <a ng-if="$c.data.id" ng-click=" $c.Copy($c.data) " href="javascript:" class="right btn-flat green-text text-darken-3">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 30 30" class="green-fill fill-darken-3" style="height: 1.5rem;" ng-include=" 'svg/copy' " />
        <span>Копия</span>
      </a>
      <span ng-show=" $c.data['это копия'] " class="right btn-flat green-text text-darken-3 ">Это копия</span>
      
      <a ng-if="$c.data.id && $c.PrintDocx() " ng-click=" $c.PrintDocx($event) " href="javascript:" class="right btn-flat black-text">
        <svg ng-hide="$c.cancelerHttp" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 50" class="blue-fill" style="height: 1.5rem;" ng-include=" 'svg/ms-word' " />
        <span ng-show000="---->ng-class" class="blue-text" ng-class="{'loader-letter-show': $c.cancelerHttp}"><span ng-repeat="l in 'загрузка...' track by $index" ng-class=" 'letter-'+($index+1) " class="loader-letter">{{ l }}</span></span>
      </a>
      
      <h3 class="fw500" ng-class="{'red-text text-darken-3': $c.data['перемещение'],}">
        <!--svg ng-show=" !$c.data.id " xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 50" class="teal-fill fill-darken-4" style="height: 1.5rem;"><use xlink:href="/fonts/icons.svg#asterisk"></use></svg-->
        <svg ng-show=" $c.data['перемещение'] " xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 50" class="rotate90left red-fill-darken-3" ng-class="t1.svgClass" style="height: 1.5rem;"><use xlink:href="/fonts/icons.svg#2arrows-180vert"></use></svg>
        <!--i ng-show=" !$c.data['перемещение'] " class="icon icon-star fs14"></i-->
        <i ng-show=" !$c.data['перемещение'] " class="material-icons ">add_circle_outline</i>
        <span>{{ $c.data['перемещение'] ? 'Перемещение ТМЦ' : 'Закупка ТМЦ' }}</span>   <!--span ng-show="!$c.data.id">(новая)</span-->   
        
        <sup><svg ng-show=" !$c.data.id " xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 50" ng-class="{'red-fill-darken-3': $c.data['перемещение'], 'teal-fill-darken-3': !$c.data['перемещение']}" ng-class=" " style="height: 1rem;"><use xlink:href="/fonts/icons.svg#asterisk"></use></svg></sup>
        <span ng-hide="!$c.data.id" class="grey-text fs8">#{{$c.data.id}}</span>
      </h3>
      <div class="divider  row000" ng-class="{'teal darken-3': $c.data.id, 'teal darken-4': !$c.data.id}" style="margin-bottom: 1rem;"></div>
      
      <div class="row" style="margin:0;">
        
        <div class="col s2" style="margin: 0.5rem 0; padding: 0;">
          <div class="chip z-depth-1 padd-05 teal lighten-4">
            <h4 class="fw500"> 
              <!--i class="material-icons">today</i-->
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 26 26" class="teal-fill fill-darken-3" style="height: 1.5rem;" ng-include=" 'svg/start-date' " />
              <span>Дата загрузки / отправки</span>
              <f ng-show=" !$c.data['дата1'] " class="chip red white-text" style="padding:0.5rem;"></sup>
            </h4>
            <div class="input-field" style="">
              <input name="дата1" type="text" class="datepicker" ng-value=" $c.data['дата1формат'] " ng-focus=" $c.FocusPickerDate($event.target) " data-value-000="{{ $c.data['дата1'] }}" placeholder000=""  style000="padding-left: 3rem; margin-left: 0px;">
            </div>
          </div>
          
        </div>
        
        <div class="col s10" style="padding: 0 0 0 0.5rem;">
        <div ng-repeat="ko in $c.data.contragent4" ng-init="ko['индекс в массиве'] = $index" class="row">
          <div ng-if="!$c.param['перемещение']" class="col s6 card padd-05 green lighten-4" ng-class-000="{'push-s6': $c.param['перемещение']}">
          <!--
            <h4 class="green-text text-darken-2"> 
              <i class="material-icons">business</i>
              <span>Поставщик</span>
            </h4>
            <contragent-item data-item="$c.data.contragent"  data-on-select="$c.OnSelectContragent(item)"></contragent-item>
            -->
            <div class="" style000="padding:0.3rem 0.7rem;">
              <div>
                <h4 class="fw500 relative"> 
                  <svg  xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48" class="teal-fill fill-darken-3" style="height: 1.5rem;" ng-include=" 'svg/arrow-left-up-round' " />
                  <span>Поставщик-грузоотправитель</span>
                  <span ng-show="$c.data.contragent4.length > 1" class="chip000">№{{ $index+1 }}</span>
                  <sup ng-show=" !ko.title " class="chip red white-text" style="padding:0.5rem;"></sup>
                  <a ng-show="!!ko.title && $index === 0" ng-click="$c.PushContragent4()" href="javascript:" class="right000" style="position: absolute; z-index: 1; right:0; top:0.2rem;"><svg  xmlns="http://www.w3.org/2000/svg" viewBox="0 0 26 26" class=" teal-fill fill-darken-3" style="height: 1.5rem;" ><use xlink:href="/fonts/icons.svg#plus-square2" /></svg></a>
                  <a ng-show="$index !== 0" ng-click="$c.SpliceContragent4($index)" href="javascript:" class="right000" style="position: absolute; z-index: 1; right:0; top:0.2rem;"><svg  xmlns="http://www.w3.org/2000/svg" viewBox="0 0 26 26" class=" red-fill fill-darken-3" style="height: 1.5rem;" ><use xlink:href="/fonts/icons.svg#minus-square" /></svg></a>
                </h4>
                <contragent-item data-item="ko" data-param="$c.data.contragent4Param[$index]" data-on-select="$c.OnSelectContragent4(item)"></contragent-item>
              </div>
              
              
              <h4 class="fw500"> <!--  title="{{ $c.data.contact2 | json }}"-->
                <svg  xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 50" class="teal-fill fill-darken-3" style="height: 1.5rem;" ng-include=" 'svg/person' " />
                <span>Контактное лицо</span>
              </h4>
              <transport-ask-contact  ng-if="!!ko.title && $c.data.contact4Param[$index] !== undefined" data-item="$c.data.contact4[$index]" data-param="$c.data.contact4Param[$index]"></transport-ask-contact>
            </div>
          </div>

          <div class="col s6"  ng-class-000="{' pull-s6 ': $c.param['перемещение']}">
            <!--div>adr1: {{ $c.data.address1 | json }}</div-->
            <!--div>addressParam: {{ $c.data.addressParam | json }}</div-->

          <div ng-hide000="!ko.title" class="card padd-05  lighten-4" ng-class="{'blue': $c.param['перемещение'], 'green': !$c.param['перемещение']}" ng-init=" index1 = $index">
            <h4 class="fw500"> 
              <svg  xmlns="http://www.w3.org/2000/svg" viewBox="0 0 26 26" class="teal-fill fill-darken-3" style="height: 1.5rem;" ng-include=" 'svg/from-location' " />
              <span ng-hide="$c.param['перемещение']">Адрес загрузки</span>
              <span ng-show="$c.param['перемещение']">Перемещение с объекта (склада)</span>
              <sup ng-hide=" $c.ValidAddress1() " class="chip red white-text" style="padding:0.5rem;"></sup>
            </h4>
            
            <!--div ng-if="$c.param['перемещение'] && $c.data['$с объекта']">
              <object-address ng-init=" param = {'не изменять': !0, 'только объекты':!0} "  data-data=" $c.data['$с объекта'] " data-param=" param "></object-address>
            </div-->
            
            <ul ng-if="$c.data.addressParam[index1] || $c.param['перемещение']" ng-init=" adr1=$c.data.address1[index1] " style="margin:0;">
              <li ng-repeat="aa1 in adr1" ng-init-000="aa1._parentAddr = adr1" ng-style000=" $index === 0 ? {} : {'padding-left': '2rem'} " class="relative">
                <object-address ng-init=" param = $c.InitAddressParam(aa1, index1, $index) "  data-data=" aa1 " data-param=" param " data-on-change="$c.OnChangeAddress(item, param)" data-on-select="$c.OnSelectAddress(item, param)"></object-address>
              </li>
            </ul>
          </div>
        </div>
        
        <div  ng-if="$last" ng-class="{'row-000 col s12': !$c.data['перемещение']}" style="padding:0;">
          <div class="col s6" ng-class="{'padd-05': $c.data['перемещение']}" style="padding:0;">
            <!--div class="input-field teal lighten-4 card padd-05">
              <input type="checkbox" id="transportChb" ng-model="$c.data['без транспорта']" ng-style="{'before-white': !$c.data['без транспорта']}" ng-change="" style="display:none;">
              <label for="transportChb" class="chb-yellow-lighten-4 teal-text text-darken-3" title="не заказывать в транспортном отделе"><h4>Не нужен транспорт (транспорт поставщика)</h4></label>
            </div-->
          </div>
          
          <!--- $c.param['закупка на складе'] означает что закупка на складе-->
          <div ng-if="!$c.data['перемещение'] && !$c.param['закупка на складе'] " class="col s6 offset-s1-000 " style="">
            <!--div>
              <input type="checkbox" id="Base1" ng-model="$c.data['через базу']" ng-change=" $c.Base1CheckboxChange($c.data) " style="display:none;" class="" ng-disabled="!$c.data.contragent4[0].title">
              <label ng-show="1" for="Base1" class="hover-shadow3d" title="{{ $c.data['база1'] | json }}">
              </label>
            </div-->
            
            <div class="input-field  lighten-5 card padd-05" ng-class="{'grey': $c.data['$на объект'].id, 'navy': !$c.data['$на объект'].id}">
              <h4 class="navy-text fw500" title000="{000{ $c.data['$на объект'] }}">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="navy-fill" style="height: 2rem;"><use xlink:href="/fonts/icons.svg#tracking" /></svg>
                <span>Через склад(базу)</span>
                <sup ng-hide="$c.ValidPosNomenInstrument($c.data)" class="chip red white-text" style="position: absolute; z-index: 1; top:0;padding:0.5rem;"></sup>
              </h4>
              <object-address ng-if="$c.paramBase1" data-data=" $c.data['$на объект'] " data-param=" $c.paramBase1 " data-on-focus-000=" $c.OnFocusBase1(ctrl) "></object-address>
            </div>
          </div>
        </div>
        
        </div><!-- row contragent4 -->
        
        </div><!-- col s10 -->
      </div><!-- row -->
      
      <!--div ng-if="!!$c.param['объект'].id" class="row" style="margin:0;">
        <div class="col s5 offset-s2 input-field blue lighten-4 chip" style="padding:0.5rem;">
          <h4 class="blue-text text-darken-3" title="">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 26 26" class="blue-fill fill-darken-3" style="height: 1.5rem;"><use xlink:href="/fonts/icons.svg#to-location" /></svg>
            <span>На объект</span>
          </h4>
          <h4 class="chip block z-depth-1 blue darken-3 white-text bold">{{$c.param['объект'].name}} ({{ $c.param['объект']['проект'].name }})</h4>
        </div>
      
      </div-->
      
      <!--h4 ng-if="!!$c.param['объект'].id" class="row" style="margin:0;">
        <span class="col s2 right-align">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 26 26" class="teal-fill fill-darken-3"  style="height: 1.2rem;"><use xlink:href="/fonts/icons.svg#to-location" /></svg>
          <span>На объект</span>
        </span>
        <span class="col 10 chip z-depth-1 blue darken-3 white-text bold">{{$c.param['объект'].name}} ({{ $c.param['объект']['проект'].name }})</span>
      </h4-->
      

      
      <div class="row chip000 relative " style="margin:0.5rem 0;">
     
     <!--- костыль долгая инициализация при редактировании в строке ТМЦ --->
      <!--tree-item ng-hide="1" data-param="{'placeholder': 'выбрать или новая позиция справочника'}" data-item="{}" data-data="[]"></tree-item--->
     
     <!--div class="fs8">{{ $c.data['@позиции тмц'] | json }}</div-->
      <h4 class="fw500 helmet tab-shadow active z-depth-1  lime lighten-4" title="">
        Позиции ТМЦ
        <sup class="chip000 middle white-text-000  bold000" ng-class="{'red-text': $c.data['@позиции тмц'].length === 0, '': $c.data['@позиции тмц'].length > 0}" style="">{{ $c.data['@позиции тмц'].length }}</sup>
      </h4>
      <table class="tmc top striped bordered lime lighten-4 z-depth-1" style000="margin: 3rem 0;">
        <thead class=""><tr>
          <th class="center vbottom" style="width:1%;">
            <h5 class="fw500">№</h5>
          </th>
          <th class="center vbottom" style="width:1%;">
            <a ng-show="!$c.data.id" ng-disabled000="$c.param['объект'].id === 0" ng-click="$c.AddPos(0)" href="javascript:" class="btn-flat" style="padding: 0;" title="добавить строку">
              <i class="material-icons lime-text-darken-3 fs18">add_box</i>
            </a>
          </th>
          <!--th ng-if="!$c.data['перемещение']" class="center" style="width:7rem;">
            <h5 class="fw500 relative">
              На дату<sup ng-hide="$c.ValidDate1($c.data)" class="chip red white-text" style="position:absolute; top:0;padding:0.5rem;" />
            </h5>
          </th--->
          <th ng-if000="$c.param['объект'].id === 0" class="center " style="width:25%;">
            <h5 class="fw500 relative">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 26 26" class="teal-fill fill-darken-3" style="height: 1.2rem;"><use xlink:href="/fonts/icons.svg#to-location"></use></svg>
              На объект (склад)<sup ng-hide="$c.ValidObject($c.data)" class="chip red white-text" style="position: absolute; z-index: 1; top:0;padding:0.5rem;"></sup>
            </h5>
            <div class="left-align">
              <object-address data-data=" {} " data-param="{'только объекты': true, placeholder:'все позиции на объект-получатель', 'inputClass4Object': 'blue-text text-darken-4', 'autocompleteClass4Object': 'blue-text text-darken-4'}" data-on-select="$c.AllPos2Object(item, param)" class="block fw500"></object-address>
            </div>
          </th>
          
          <th class="center " ng-style="!$c.data['перемещение'] ? {'min-width':'35%'} : {'min-width':'45%'}">
            <h5 class="fw500 relative">
              Наименование, ед. изм.<sup ng-hide="$c.ValidNomen($c.data)" class="chip red white-text" style="position: absolute; z-index: 1; top:0;padding:0.5rem;"></sup>
            </h5>
          </th>
          <th class="center " style="width:5%;">
            <h5 class="fw500 relative">
              Кол-во<sup ng-hide="$c.ValidKol($c.data)" class="chip red white-text" style="position: absolute; z-index: 1; top:0;padding:0.5rem;"></sup>
            </h5>
          </th>
          <!--th class="center" style="width:5rem;">Ед. изм.</th-->
          <th ng-if="!$c.data['перемещение']" class="center " style=" width:7%;">
            <h5 class="fw500 relative">
              Цена ₽<sup ng-hide="$c.ValidCena($c.data)" class="chip red white-text" style="position: absolute; z-index: 1; top:0;padding:0.5rem;"></sup>
              <div class="grey-text tborder">сумма ₽</div>
            </h5>
          </th>
          <!--th ng-if="!$c.param['не списывать']" class="center vbottom" style="width:1%;" title="без подтверждения на объекте-получателе">
            <h5 class="fw500">Списать</h5>
          </th--->
          <!---th ng-if="!$c.data['перемещение']" class="center" style="width:5rem;">
            <h5 class="fw500">
              Сумма
            </h5>
          </th--->
          <th class="center" style="width:12%;">
            <h5 class="fw500">
              Примечание
            </h5>
          </th>
        </tr></thead>
        <tbody>
          <tr ng-repeat="row in $c.data['@позиции тмц'] | filter: $c.FilterPos " ng-attr-id="{{ 'row-index-'+$index }}" ng-init="$c.InitRow(row, $index)">
            <td class="right-align relative" style=" vertical-align:middle;">
              <span title="{{ row | json }}">{{ $index+1 }}</span>
              <span ng-show="!!row.id" class="fs7 grey-text" style="position: absolute; z-index: 1; bottom:0; left:0;" title="{{ row | json }}">#{{ row.id }}</span>
            </td>
            <td class="center middle" style="">
              <div class="hover-childs-show relative">
              <span class="chip padd-0 hover-parent-hide-child"><i class="material-icons">more_horiz</i></span>
              <span class="chip padd-10 nowrap hover-parent-show-inline absolute animated fadeIn" style="left:0rem; top:-2rem; z-index:1;">
                <a ng-hide-000="!$c.FilterValidPos(row)"  ng-click="$c.CopyPos($index)" href="javascript:" class="btn-flat z-depth-1 green lighten-4" title="копировать строку">
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 30 30" class="green-fill fill-darken-3 ng-scope" style="height: 1.2rem;"><use xlink:href="/fonts/icons.svg#copy"></use></svg>
                </a>
                <a ng-click="$c.DeleteRow($index)" href="javascript:" class="btn-flat z-depth-1 red lighten-4" title="удалить строку">
                  <i class="material-icons red-text  ">delete_forever</i>
                </a>
                <a ng-show="$last || !$c.data.id" ng-disabled000="$c.param['объект'].id === 0" ng-click="$c.AddPos($index+1)" href="javascript:" class="btn-flat z-depth-1 lime lighten-3" title="добавить строку">
                  <i class="material-icons lime-text-darken-3 ">add_box</i>
                </a>
              </span>
            </div>
              
            </td>
            <!--td ng-if="!$c.data['перемещение']" class="center" ng-class="{vbottom: $c.param['объект'].id}">
              <div ng-if="(row['$тмц/заявка'] && row['$тмц/заявка']['дата1']) || row['дата1']" ng-init="$c.DatePickerRow('row-index-'+$index+' .datepicker', row)"  class="input-field" style=";">
                <input name="date" type="text" class="datepicker"  data-value="{{ (row['$тмц/заявка'] && row['$тмц/заявка']['дата1']) || row['дата1'] }}" ng-disabled="row['$тмц/заявка'].id" placeholder000=""  style000="padding-left: 3rem; margin-left: 0px;">
              </div>
              
            </td-->
            <td ng-if000="$c.param['объект'].id === 0" class="padd-05">
              <div ng-if="row['$тмц/заявка'] && row['$тмц/заявка'].id" class="chip padd-0-05 orange lighten-3 blue-text text-darken-3 truncate border">
                <!--svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 26 26" class="blue-fill"  style="height: 1.2rem;"><use xlink:href="/fonts/icons.svg#to-location" /></svg-->
                <i class="icon icon-star"></i>
                <span title="заявка-объект">{{ row['$объект'].name }}</span> <!--span>{{ row['$объект'] | json }}</span-->
              </div>
              <!--div>{{ angular.copy(row['$объект']) | json }}</div-->
              <object-address ng-if="(!row['$тмц/заявка'] || !row['$тмц/заявка'].id) && !row['$объект']._refresh " data-data=" row['$объект'] " data-param="{'не изменять000': !!row['количество/принято'], 'только объекты': true, placeholder:'объект-получатель', 'inputClass4Object': 'blue-text text-darken-4', 'autocompleteClass4Object': 'blue-text text-darken-4'}" data-on-focus=""></object-address>
              <!--div class="white-space: pre;">{{row['$объект']|json}}</div-->
              <!--div ng-if="$c.param['объект'].id">{{$c.param['объект'].name}}</div-->
              <div ng-show="row['$тмц/заявка'] && row['$тмц/заявка'].id" class="truncate">
                
                <span class="chip shadow-inset-10 padd-0-05 black-text fs8" title="заявка-заказчик">
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 50" class="black-fill fill-darken-3"  style="height: 1rem;"><use xlink:href="/fonts/icons.svg#person" /></svg>
                  {{ row['$тмц/заявка']['$профиль заказчика'].names.join(' ') }}
                </span>
                <span class="chip padd-0-05 orange-text text-darken-4" style="padding: 0 0.5rem;" title="заявка на дату">
                  <span class="fs8"> {{ (row['$дата1'] && row['$дата1']['день нед']) || (row['$тмц/заявка']['$дата1'] && row['$тмц/заявка']['$дата1']['день нед']) }} </span><!--- || (row['$ts'] && row['$ts']['день нед']) -->
                  <!--br-->
                  <span class="bold"> {{ (row['$дата1'] && row['$дата1']['day']) || (row['$тмц/заявка']['$дата1'] && row['$тмц/заявка']['$дата1']['day'])  }} </span><!---  || (row['$ts'] && row['$ts']['day'])-->
                  <!--br-->
                  <span class="fs8"> {{ (row['$дата1'] && row['$дата1']['мес']) || (row['$тмц/заявка']['$дата1'] && row['$тмц/заявка']['$дата1']['мес'])   }} </span><!--- || (row['$ts'] && row['$ts']['мес']) -->
                </span>
                <span class="fs7 grey-text" title="{{ row['$тмц/заявка'] | json }}">#{{ row['$тмц/заявка'].id }}</span>
              </div>
              <!--div ng-if="(row['$тмц/заявка'] && row['$тмц/заявка']['дата1']) || row['дата1']" ng-init="$c.DatePickerRow('row-index-'+$index+' .datepicker', row)"  class="input-field" style=";">
                <input name="date" type="text" class="datepicker"  data-value="{{ (row['$тмц/заявка'] && row['$тмц/заявка']['дата1']) || row['дата1'] }}" ng-disabled="row['$тмц/заявка'].id" placeholder000=""  style000="padding-left: 3rem; margin-left: 0px;">
              </div-->
            </td>
            <td class="padd-05" style="" ng-init=" row.nomen._edit = !row['номенклатура/не изменять'] && !row.id ">
              <!-- !row['количество/принято'] && $c.EditNomenRow(row) -->
              <h5 ng-if="row['номенклатура'] && row['номенклатура'].length && !(row['наименование'] && row['наименование'].length)" ng-hide="row.nomen._edit"><a ng-click=" $c.EditNomenRow(row)" class="hover-shadow3d" href="javascript:"><span ng-repeat="n in row['номенклатура'] track by $index" class="breadcrumb brown-text before-margin-0"><span class="chip padd-0-05 shadow-inset-10">{{n}}</span></span></a></h5>
              <tree-item ng-if=" row.nomen._edit " ng-init="param = {'placeholder': !!$c.data['перемещение'] ? 'выбрать позицию из остатков' : 'выбрать или новая позиция номенклатуры ТМЦ', 'не добавлять новые позиции': !!$c.data['перемещение'], 'подпись не найдно': !!$c.data['перемещение'] ? 'Не найдено на остатках' : 'не найдено ТМЦ', 'autocompleteOnlyFinalItems0000': !!$c.data['перемещение'], 'autocompleteFilter': $c.NomenAutocompleteFilter, 'autocomplete': {'AppendSuggestions':$c.NomenAutocompleteAppendSuggestions}}" data-param=" param " data-item="row.nomen" data-data=" $c['@номенклатура'] " data-lookup-complete=" $c['@номенклатура/lookupComplete'] " data-on-focus-field="$c.FocusRow(row)" data-on-select-item="$c.OnSelectItemNomen(item, param)" class="block"></tree-item>
              <!--- предварительное наименование от снабжения --->
              <h6 ng-if="row['наименование'] && row['наименование'].length"><a ng-click=" $c.EditNomenRow(row)" class="hover-shadow3d" href="javascript:"><span ng-repeat="n in row['наименование'] track by $index" class="breadcrumb before-margin-0"><span class="chip navy-lighten-5 navy-text padd-0-05 border">{{n}}</span></span><span class="chip padd-0-05 grey-text fs8 right">это закупочное наименование позиции</span></a></h6>
              <h6 ng-if=" row['$тмц/заявка'] && row['$тмц/заявка']['наименование'] " class="chip padd-0-05 fs8 orange-text-darken-4 orange lighten-4 border fw500 right" title="наименование в заявке"><i class="material-icons orange-text-darken-4">playlist_add_check</i> {{ row['$тмц/заявка']['наименование'] }}</h6>
              <div ng-if="$c.IsNomenInstr && $c.IsNomenInstr(row) && row['количество'] != '1' " class="clearfix card padd-05 fs8 navy-text text-darken-1 red lighten-3 fw500 border-000 animated zoomInUp fast"><i class="material-icons red-text-darken-3">warning</i>Инструмент -- количество в 1 строке -- 1 шт! Если больше -- <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 30 30" class="green-fill fill-darken-3 ng-scope" style="height: 1.2rem;"><use xlink:href="/fonts/icons.svg#copy"></use></svg> копировать готовую строку</div>
            </td>
            <td class="padd-05">
              <div class="input-field" ng-init=" row['количество'] = (row['$тмц/заявка'] && row['$тмц/заявка']['количество/докупить']) || row['количество']">
                <input  type="text" ng-model="row['количество']" ng-change="$c.ChangeKol($last, row)" ng000-focus="$c.FocusRow(row)" placeholder="кол-во" class="right-align" style="/*max-width:3rem;*/" ng-disabled-000="!!row['количество/принято']">
              </div>
              <h6 ng-if=" row['$тмц/заявка'] && row['$тмц/заявка']['количество'] "class="chip padd-0-05 orange-text-darken-4 orange lighten-4 border bold" title="количество по заявке">{{ row['$тмц/заявка']['количество'] }}</h6>
            </td>
            </td>
            
            <!--td class="vbottom">
              <div class="input-field">
                <input  type="text" ng-model="row['ед']" ng000-focus="$c.FocusRow(row)" placeholder="ед" class="right-align">
              </div>
            </td-->
            
            <td ng-if="!$c.data['перемещение']" class="padd-05">
              <div ng-if-000="row['$тмц/заявка']" class="input-field">
                <input  type="text" ng-model="row['цена']" ng-change="$c.ChangeSum(row)" placeholder="цена"  class="right-align" style="/*max-width:3rem;*/" ng-disabled-000="!!row['количество/принято']">
              </div>
              <div class="input-field">
                <input  type="text" ng-model="row['сумма']" ng-disabled="1" class="right-align" style="/*max-width:4rem;*/">
              </div>
            
            <!-- списать -->
            <!--td ng-if="!$c.param['не списывать']" class="center padd-05">
              <div class="input-field chip-000 padd-05" ng-init=" disabled = !!row['количество/принято'] && !row['списать'] ">
                <input type="checkbox" ng-attr-id="{{'chb-spis-'+$index}}" ng-model="row['списать']" ng-style-000="000{'before-yellow-lighten-4': }" ng-change=""  ng-disabled=" disabled ">
                <label for="{{'chb-spis-'+$index}}" class="chb-red-lighten-3 red-text text-darken-3" title="сразу списать на объекте получателе"></label>
              </div>
            </td--->
            
            <td class="padd-05">
              <div class="input-field">
                <textarea ng-model="row['коммент']" class="materialize-textarea fs8" style="font-size:0.8rem; padding:0; min-height: 3rem; /*max-width:5rem;*/"></textarea>
              </div>
              
              <!--div class="fs8 pre-wrap">{{ row | json }}</div-->
              
              <!-- принятая позиция-->
              <!--div ng-if="row['количество/принято']" class="input-field000 chip shadow-inset-10 red-text text-darken-2" style="" title="позиция принята получателем">
                  <svg  xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 50" class="red-fill fill-darken-2" ng-class-000="{'green-fill': !row['на объект/id'], 'blue-fill': !!row['на объект/id'] }" style="height: 1.5rem;"><use xlink:href="/fonts/icons.svg#checked1"></use></svg>
                  <span ng-show="row['списать']" class="fs8">списано</span>
                  <span ng-hide="row['списать']" class="fs8">получено</span>
                  <span class="center chip vtop white  z-depth-1 fs10" ng-class-000="{'green-text': !row['на объект/id'], 'blue-text': !!row['на объект/id'] }" style="padding:0 0.3rem;" title="дата приема ТМЦ">
                    <span class="fs8 ">{{ row['$дата/принято']['день нед'] }}</span>   <span class="bold">{{ row['$дата/принято']['day'] }}</span>  <span class="fs8">{{ row['$дата/принято']['мес'] }}</span>
                  </span>
                <h5 class="chip-000 nowrap" style="padding: 0 0.5rem;" title="кто принял">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 50" class="red-fill fill-darken-3" ng-class-000="{'green-fill': !row['на объект/id'], 'blue-fill': !!row['на объект/id'] }" style="height: 1rem;"><use xlink:href="/fonts/icons.svg#person" /></svg>
                    <span class="fs8 red-text text-darken-3" ng-class-000="{'green-text': !row['на объект/id'], 'blue-text': !!row['на объект/id'] }">{{ row['$принял'].names.join(' ') }}</span>
                  </h5>
              </div-->
            </td>
            
          </tr>
        </tbody>
      
      </table>
      <!-- кнопка для больших списков -->
      <!--div ng-show="$c.data['@позиции тмц'].length > 3" class="absolute" style="left:-2rem; bottom: 0;">
        <a ng-disabled000="$c.param['объект'].id === 0" ng-click="$c.AddPos()" href="javascript:" class="btn-flat" style="padding: 0;" title="добавить строку">
              <i class="material-icons green-text fs18">add_box</i>
            </a>
      </div-->
      </div><!-- row -->
      
      <div class="row">
        <div class="input-field chip block teal lighten-4 z-depth-1 col s12 m6" style="margin:0; padding:0.5rem;">
          <h5>Примечание</h5>
          <textarea ng-model="$c.data['коммент']" class="materialize-textarea" style="font-size:0.8rem; padding:0; min-height: 2rem;"></textarea>
        </div>
      </div>
      
      
      <div ng-show="$c.error" class="red-text">{{ $c.error }}</div>
      <div ng-show="$c.cancelerHttp" ng-include=" 'progress/save' "></div>
    
    </div>
    <div ng-hide="$c.cancelerHttp" class="card-action center green lighten-4">
      <span ng-hide="$c.Valid()" class="chip red-text text-lighten-1 left">для сохранения обязательные поля отмечены<sup class="chip red white-text" style="padding:0.5rem;"></sup></span>
      <a class="btn" ng-click="$c.Save($event)" href="javascript:" ng-disabled-000="!$c.Valid()"><!--- не может прокачивать такую валидацию, сделал в Save() -->
        <i class="material-icons">save</i>
        <span>Сохранить</span>
      </a>
      <a ng-if="$c.data.id" class="btn red right" ng-click000="$c.OpenConfirmDelete()" href="javascript:" data-target="modal-confirm-remove">
        <i class="material-icons">delete_forever</i>
        <span>Удалить</span>
      </a>
    </div>
    </div>
  <!--div>{{ $c.data | json }}</div-->
  <!--/div-->


</div>


<!-- Modal Structure -->
<div ng-if="$c.data && $c.data.id" id="modal-confirm-remove" class="modal"  data-overlay-in="animated fade-in-05" data-overlay-out="animated  fade-out-05 fast" data-modal-in="animated slideInDown" data-modal-out="animated zoomOutUp"   style="width:50%; max-height: 50%; top:5%;">
  <div  class="modal-content">
    <h3>Точно удалить?</h3>
  </div>
  <div class="modal-footer teal-lighten-5">
    <a ng-click0000="$c.ConfirmValueNOT()" href="javascript:" class="modal-action modal-close waves-effect waves-red btn-flat white z-depth-1 red-text fs14 float-none">НЕТ</a>
    <a ng-click="$c.Delete($event)" href="javascript:" class="modal-action modal-close waves-effect waves-teal btn-flat white z-depth-1 green-text fs14">ДА</a>
    
  </div>
</div>