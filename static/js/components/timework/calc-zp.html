@@@ расчет ЗП

<div ng-init="$ctrl.InitMonth()" class="">
  <h2 class="inline" style="">Расчет ЗП за месяц</h2>
  <div class="input-field inline picker-month" style="width:10rem;">
    <input name="месяц" type="text" class="datepicker bold"  data-value="{{ $ctrl.param['месяц'] }}" style="margin:0rem; font-size:1.4rem;">
  </div>
</div>

<div ng-hide="$ctrl.ready" ng-include=" 'progress/load' "></div>



<div ng-if="$ctrl.ready">
<div ng-show="$ctrl.cancelerHttp" ng-include=" 'progress/load' "></div>

<!-- фильтровать профили -->
<div ng-if="$ctrl.data['данные/профили']" class="input-field">
  <a ng-show="$ctrl.filterProfile && $ctrl.filterProfile.length" ng-click000=" $ctrl.ChangeSelectProfile(true) " ng-click=" $ctrl.filterProfile = '' "  href="javascript:" style="position:absolute; right:0;">
    <svg  xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 50" class="middle red-fill fill-darken-1" style="height: 2rem;" ng-include=" 'svg/стереть' "></svg>
  </a>
  <input ng-model="$ctrl.filterProfile" ng-focus000="$ctrl.FocusSelectProfile($event)" ng-change000="$ctrl.ChangeSelectProfile()" placeholder="выбрать по ФИО" class="" style="margin:0; border: none;" autocomplete="off" type="text">
</div>

<!-- фильтровать без расчета" -->
<div class="input-field">
  <input type="checkbox" id="фильровать без расчета ЗП" ng-model="$ctrl['фильровать без расчета ЗП']">
  <label for="фильровать без расчета ЗП" class="middle"><h5><svg  xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="middle teal-fill fill-darken-3" style="height: 2rem;" ng-include=" 'svg/filter' " />Без расчета ЗП</h5></label>
</div>

<div ng-hide="$ctrl.data['данные'] === undefined || $ctrl.data['данные'].length">Никому не начислено в этом месяце</div>

  <table ng-if="$ctrl.data['данные'] && $ctrl.data['данные'].length" class="striped timework timework-report card">
    <thead><tr>
      <th style="width:1%;"></th>
      <th style="width:25%;">ФИО</th>
      <th style="width:5%;">Должность</th>
      <th style="width:20%;">Объект</th>
      <!--th style="width:20%;" ng-if="$ctrl.param['общий список бригад']">Бригада</th-->
      <!--th style="width:5%;">Кол-во часов</th>
      <th style="width:5%;">Кол-во смен</th>
      <th style="width:5%;">КТУ нач. уч.</th>
      <th style="width:5%;">КТУ зам. стр.</th>
      <th style="width:5%;" ng-if="$ctrl.param['общий список'] || $ctrl.param['общий список бригад'] || $ctrl.param['бригада']">Ставка сут.</th>
      <th style="width:7%;" title="Ставка руб/час или руб/смена (для группы ИТР)">Ставка раб.</th-->
      <th style="width:10%;">
        <div>Сумма, руб<div>
        <div class="green-text text-darken-3">начисления</div>
        <div class="orange-text text-darken-3">к выплате</div>
      </th>
      <!--th>Начислено</th-->
      <th style="width:7%;">Примеч.</th>
    </tr></thead>
    
    <tbody>
      <tr ng-repeat="row in $ctrl.data['данные'] | filter: $ctrl.dataFilter() | orderBy: $ctrl.OrderByData"  ng-init=" $ctrl.InitRow(row, $index) " ng-attr-id="row{{ $index }}">
        <td  class="right" style="padding:0.3rem;">{{$index+1}}</td>
        <td title000="{{ row._profile | json }}">
          <div>
            <a ng-click="$ctrl.ShowDetail(row)" href="javascript:" data-target="modal-detail">
              <svg ng-show="!!row['РасчетЗП']" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 50" class="middle orange-fill fill-darken-3" style="height: 1.2rem;" ng-include=" 'svg/крыжик1' " />
              <h5 ng-repeat="n in row._profile.names track by $index" class="inline" style="padding: 0 0.1rem;">{{n}}</h5>
            </a>
          </div>
          
        </td>
        <td class="">
          <span ng-repeat="d in row._profile['должности'] track by $index" class="truncate chip00 fs8" style="padding: 0 0.2rem; width:10rem;">{{d.name || d}}</span>
          <span ng-repeat="b in row._profile['бригада'] track by $index" class="chip00 fs8 italic blue-grey-text" style="padding: 0 0.2rem;">{{b}}</span>
        </td>
        
        <td class="right-align">
          <div ng-repeat="o in row['объекты'] track by $index" class="input-field000  truncate " ng-style="row['стиль строки объекта']" style="width:20rem;" title="{{ row['объект.name'][$index] }}">
            {{ row['объект.name'][$index] }}
          </div>
          
          <div ng-if="row['показать суточные']" class="truncate" ng-style="row['стиль строки объекта']" style="width:20rem;">
            <i class="material-icons">hotel</i>
            <span>Суточные</span>
          </div>
          
          <!--div class="print-only" style="height:12rem;"></div-->
        </td>
        
        <td class="right-align"><div>
          
          <div ng-if="row['объекты']" ng-repeat="o in row['объекты'] track by $index" class="input-field"  title000="{{ row['объект.name'][$index] }}">
            <input type="text" ng-model="row['Сумма'][$index]" ng-change000="$ctrl.SaveValue(row, 'Сумма', $index)" style="height: 2rem; text-align: right;" placeholder="или сумму" ng-disabled="true" ng-class=" {'green-text text-darken-3': !!row['Начислено'][$index], 'grey-text': !row['Начислено'][$index]} " ng-class000="{'orange-text text-darken-2': row['объекты'].length == 1 && !row['показать суточные']}">
            <!--span >{{ row['Сумма'][$index] }}</span-->
          </div>
          <!--div ng-if="row['объекты'] && row['показать суточные']" class="" ng-style="row['стиль строки объекта']"></div-->
           <!--- суточ -->
          <div ng-if="row['показать суточные']" class="input-field"><!---  суточные -->
            <input type="text" ng-model="row['Суточные/сумма']" ng-change000="$ctrl.SaveValue(row, 'Суточные/сумма', undefined, {'объект': 0})"  style="text-align:right; height: 2rem;" placeholder="сумма" ng-disabled="true" ng-class=" {'green-text text-darken-3': !!row['Суточные/начислено'], 'grey-text': !row['Суточные/начислено']} " >
          </div>
          <div ng-if="row['объекты'] && (row['объекты'].length > 1 || row['показать суточные'])" ng-init="sum = $ctrl.DataValueTotal('Сумма', row, 'Начислено').toLocaleString('ru-RU')" style="border-top: 1px solid;">
            <a ng-click="$ctrl.ShowDetail(row)" href="javascript:" class="fs12 center000 green-text text-darken-3 bold" data-target="modal-detail">
              {{ sum }}
            </a>
          </div>
          <div ng-if="!!row['РасчетЗП']" title="расчетый лист">
            <!--a ng-click="$ctrl.ToggleCalcZP(row)" href="javascript:" class="fs12 blue-text text-darken-3 bold" >
              <i class="material-icons">keyboard_arrow_down</i></a-->
              к выплате
              <span class="fs12 orange-text text-darken-3 bold">{{ parseFloat(row['РасчетЗП']).toLocaleString('ru-RU') }}</span>
            
          </div>
        </td>

        <td>
          <div ng-if="row['объекты']" ng-repeat="o in row['объекты'] track by $index" class="input-field"  title="{{ row['объект.name'][$index] }}">
            <textarea ng-model="row['Примечание'][$index]" ng-change="$ctrl.SaveValue(row, 'Примечание')" class="materialize-textarea" style="height: 2rem; min-height: auto; padding: 0px; font-size: 0.8rem; border: none;" ng-disabled="true"></textarea>
          </div>
        </td>
      
      </tr>
      <tr ng-if="!$ctrl.filterProfile" class="yellow lighten-4">
        <td colspan="4"><h3 class="right-align">ИТОГО</h3></td>
        <td >
          <div class="fs14 green-text text-darken-3 right-align" title="общая сумма начислений">{{ $ctrl.DataValueTotal('Сумма', undefined, 'Начислено').toLocaleString('ru-RU') }}</div>
          <div class="fs14 orange-text text-darken-3 right-align" title="общая сумма расчетов">{{ $ctrl.DataValueTotal('РасчетЗП').toLocaleString('ru-RU') }}</div>
        </td>
        <td></td>
      </tr>
    
    </tbody>
  
  </table>

</div>



<!-- Modal Trigger -->
<!--a class="waves-effect waves-light btn" href="javascript:">Modal</a-->

<!-- Modal Structure -->
<div id="modal-detail" class="modal" data-endingTop="8%" style="width:97%; max-height: 91%;">
  
  <div class="modal-content">
    <div class="right">
      <a href="javascript:" class="modal-action modal-close waves-effect waves-green red-text btn-flat">
        <svg  xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="red-fill" style="height: 1.5rem;" ><use xlink:href="/fonts/icons.svg#cancel" /></svg>
        <span>Закрыть</span>
      </a>
    </div>
    <div class="center">
      <h3 ng-repeat="n in $ctrl.showDetail._profile.names track by $index" class="inline" style="padding: 0 0.1rem;">{{n}}</h3>
      <h3 class="inline chip white-text purple darken-3" style="padding:0.5rem;">{{ dateFns.format($ctrl.showDetail['месяц'], 'MMMM YYYY', {locale: dateFns.locale_ru}) }}</h3>
    
    </div>

    
    <div ng-if="$ctrl.showDetail['параметры расчетов']">

      <money-table data-param="$ctrl.showDetail['параметры расчетов']"></money-table>
      
      <timework-pay-form data-param="$ctrl.showDetail['параметры расчетов']" data-on-close-pay="$ctrl['Закрытие расчета'](item)"></timework-pay-form>
      
      <!--a ng-click=" add_money = true " href="javascript:" class="btn-flat right blue-text">
        <i class="material-icons">add_box</i>
        <span>Добавить запись ДС</span>
      </a-->
      
      <money-form ng-if000="add_money" data-param="$ctrl.showDetail['параметры расчетов']" data-on-save="$ctrl.ShowDetailOnSaveMoney(data)" data-data000="$ctrl.showDetail['движение ДС']"></money-form>
    </div>
    
    <!--div class="modal-footer000">
      <a href="javascript:" class="modal-action modal-close waves-effect waves-green btn-flat">Закрыть</a>
    </div-->
  </div>
  
</div>

</div>