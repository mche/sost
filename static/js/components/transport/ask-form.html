
@@@ transport/ask/form

<div ng-hide="$ctrl.ready" ng-include=" 'progress/load' "></div>
<div ng-if="$ctrl.ready">
  
  <div ng-if000="$ctrl.param['объект']" ng-init000="$ctrl.Cancel()">
    <div ng-hide="$ctrl.data" class="" style="position: absolute; top: 0; right: 0"><a class="btn" ng-click="$ctrl.Open()" href="javascript:" ng-disabled0000="!$ctrl.param['объект'].id">
      <i class="material-icons">note_add</i>
      <span>Новая заявка</span>
    </a></div>
    
    <!--div ng-show="$ctrl.data" style="white-space:pre-wrap; height:10rem; overflow:auto">{{ $ctrl.data | json }}</div-->
    
    <div ng-if="$ctrl.data" class="card teal lighten-5">
      
    <div class="card-content" ng-init="$ctrl.InitForm()">

      <a ng-click="$ctrl.Cancel()" href="javascript:" class="right btn-flat orange-text">
        <i class="material-icons">cancel</i>
        <span>Отмена</span>
      </a>
      
      <h3 class="bold center">
        <span ng-show="!$ctrl.data.id" class="orange-text">Новая заявка на транспорт</span>
        <span ng-hide="!$ctrl.data.id" class="">Редактировать заявку на транспорт</span>
        <span ng-show="$ctrl.data.id" class="grey-text fs8">#{{$ctrl.data.id}}</span>
      
      </h3>
      <div class="divider  row" ng-class="{'teal darken-3': $ctrl.data.id, 'orange': !$ctrl.data.id}" style="height:3px;"></div>
      
      <div class="row">
        
        <div class="col s12 m6 l3">
          <h4 class=""> 
            <i class="material-icons">today</i>
            <span>Дата начала работы (загрузка)</span>
            <!--sup class="orange-text">*</sup-->
            <sup ng-hide=" !!$ctrl.data['дата1'] " class="chip orange white-text" style="padding: 0.3rem;"></sup>
          </h4>
          <div class="input-field" style="">
            <input name="дата1" type="text" class="datepicker"  data-value="{{ $ctrl.data['дата1'] }}" placeholder000=""  style000="padding-left: 3rem; margin-left: 0px;">
          </div>
        </div>
        
        
      </div>
      
      <div class="row" style000="margin: 3rem 0rem;">
        
        <div class="col s12 m12 l4">
          <!--h3 class="center"><sup class="orange-text">*</sup>Получатель</h3>
          <div class="divider"></div-->
          
          <!--------div class="row">
            <div class="col s12" ng-class000="{'hidden': !!$ctrl.data.project.title || !!$ctrl.data.contragent1.title}"-------->
              <h4 class="bold"> 
                <i class="material-icons">file_download</i>
                <span>Заказчик</span>
                <!--sup class="orange-text">*</sup-->
                <sup ng-hide=" !!$ctrl.data.contragent2.title " class="chip orange white-text" style="padding: 0.3rem;"></sup>
              </h4>
              <contragent-item ng-if="$ctrl.data.contragent2Param" data-item="$ctrl.data.contragent2" data-param="$ctrl.data.contragent2Param" data-on-select="$ctrl.OnSelectContragent2(item)"></contragent-item>
        </div>
            
            <!--div class="col s6" ng-class="{'hidden': !!$ctrl.data.contragent2.title}">
              <h4 class="">
                <span ng-hide="$ctrl.data.project.title" class="grey-text">или</span>
                <i class="material-icons">star</i>
                <span>Наш проект</span>
              </h4>
              <project-item data-data="$ctrl.data.project"  data-on-select="$ctrl.OnSelectProject(item)"></project-item>
            </div-->
          <!---------/div>
        </div----->
        
        <div class="col s12 m12 l4">
          <!--h3 class="center">Адрес назначения</h3>
          <div class="divider"></div-->
          
          <!---------div class="row">
            <div class="col s6"------->
              <h4 class=""> 
                <!--i class="material-icons">place</i-->
                <span>Откуда</span>
                <i class="material-icons">forward</i>
              </h4>
              <!--div class="input-field" style="">
                <input name="откуда" type="text"  ng-model="$ctrl.data['откуда']" placeholder="адрес"  style000="padding-left: 3rem; margin-left: 0px;">
              </div-->
              <div ng-if="$ctrl.data.addressParam" ng-repeat="a1 in $ctrl.data.address1">
                <object-address  data-data=" a1 " data-param="$ctrl.data.addressParam" data-on-select="$ctrl.OnSelectAddress(item)"></object-address>
              </div>
        </div>
            
        <div class="col s12 m12 l4">
              <h4 class=""> <!--  title="{{ $ctrl.data.address2 | json }}"-->
                <!--i class="material-icons">place</i-->
                <i class="material-icons">forward</i>
                <span>Куда</span>
                <!--sup class="orange-text">*</sup-->
                <sup ng-hide=" $ctrl.Address2Hide() " class="chip orange white-text" style="padding: 0.3rem;"></sup>
              </h4>
              <div ng-if="$ctrl.data.addressParam" ng-repeat="a2 in $ctrl.data.address2">
                <object-address  data-data=" a2 " data-param="$ctrl.data.addressParam" data-on-select="$ctrl.OnSelectAddress(item)"></object-address>
              </div>
              
            </div>
      </div>
        <!-----/div>
        
      </div--->
      <div class="row">
        
        <div class="col s12 m4">
          <h4 class=""> <!--  title="{{ $ctrl.data.contact2 | json }}"-->
            <i class="material-icons">person</i>
            <span>Контактное лицо заказчика</span>
          </h4>
          <transport-ask-contact  ng-if="$ctrl.data.contragent2.title && $ctrl.data.contact2Param" data-item="$ctrl.data.contact2" data-param="$ctrl.data.contact2Param"></transport-ask-contact>

        </div>
      
        <div class="input-field col s12 m8" style000="margin: 3rem 0rem;">
          <div class="right">
            <span ng-hide="$ctrl.data['без груза']" class="grey-text middle">или</span>
            <input type="checkbox" id="gruzOff" ng-model="$ctrl.data['без груза']" ng-change="$ctrl.ChangeGruzOff()">
            <label for="gruzOff"><i class="material-icons">remove_shopping_cart</i> без груза</label>
          </div>
          <h4 ng-class="{'grey-text through':$ctrl.data['без груза']}">
            <!--input type="checkbox" name="gruzOn" ng-model="$ctrl.data.gruzOn" ng-change="$ctrl.ChangeGruzOn()">
            <label for="gruzOn">Груз</label-->
            <i class="material-icons">shopping_cart</i>
            <span>Груз</span>
            <!--sup ng-hide="$ctrl.data['без груза']" class="orange-text">*</sup-->
            <sup ng-hide="$ctrl.data['без груза'] || $ctrl.data['груз']" class="chip orange white-text" style="padding: 0.3rem;"></sup>
          </h4>
          <div class="divider"></div>
          <textarea ng-model="$ctrl.data['груз']" ng-disabled="$ctrl.data['без груза']" class="materialize-textarea" style="padding:0; min-height:4rem;" placeholder="описание груза"></textarea>
        </div>
      </div>
      
      <!--div class="divider teal" style="margin-bottom: 1px;"></div><!-- разделить заказчика и перевозчика -->
      <!--div class="divider teal"></div-->
      
      <div class="row" style="margin-top:3rem;">
        
        <div class="col s12 m4" ng-class000="{'hidden': $ctrl.data.contragent1.id === null || !!$ctrl.data.contragent2.title}">
          <!--div>{{ $ctrl.data.contragent1 | json}}</div-->
          <h4 class="bold" > <!-- title="{{ $ctrl.data.contragent1 | json }}" -->
            <i class="material-icons">file_upload</i>
            <span>Перевозчик</span>
          </h4>
          <contragent-item ng-if="$ctrl.data.contragent1Param" data-item="$ctrl.data.contragent1" data000-param000="$ctrl.data.contragent1Param" data-on-select="$ctrl.OnSelectContragent1(item)"></contragent-item>
        </div>
        
        <div class="col s12 m8">
          <!--div>{{ $ctrl.data.transport | json}}</div-->
          <h4 class=""><!--  title="{{ $ctrl.data.transport | json }}"-->
            <i class="material-icons">local_shipping</i>
            <span>Машина / техника</span>
          </h4>
          <transport-item ng-if="$ctrl.data.transportParam" data-item="$ctrl.data.transport" data-param="$ctrl.data.transportParam" data-on-select="$ctrl.OnSelectTransport(item)"></transport-item>
        </div>
      </div> <!-- row -->
      <div class="row clearfix">
        
        <div class="col s12 m4">
          <h4 class=""> <!-- title="{{ $ctrl.data.contact1 | json }}"-->
            <i class="material-icons">person</i>
            <span>Контактное лицо перевозчика</span>
          </h4>
          <transport-ask-contact  ng-if="$ctrl.data.contragent1.title && $ctrl.data.contact1Param" data-item="$ctrl.data.contact1" data-param="$ctrl.data.contact1Param"></transport-ask-contact>

        </div>

        <div class="col s12 m4 " ng-class00="{'hidden': !$ctrl.data.contragent1['проект/id'] || !$ctrl.data.transport.title}">
          <h4 class="""><!-- title="{{ $ctrl.data.driver | json }} -->
            <i class="material-icons">person</i>
            <span>Водитель</span>
          </h4>
          <!--profile-item ng-if="$ctrl.data.contragent1['проект/id']" data-item="$ctrl.data.driver" data-data="$ctrl.data.driverData" data-on-select="$ctrl.OnSelectDriver(item)"></profile-item-->
          <!--  (($ctrl.data.transport._fromItem && $ctrl.data.transport._fromItem['проект/id'] && $ctrl.data.transport._fromItem['проект/id'].length) || -->
          <transport-ask-contact  ng-if=" $ctrl.data.transport.title && $ctrl.data.contragent1.title && $ctrl.data.driverParam" data-item="$ctrl.data.driver" data-param="$ctrl.data.driverParam"></transport-ask-contact>
        </div>
        
        <div class="col s12 m4">
          <h4 class=""><!--  title="{{ $ctrl.data.category | json }}"-->
            <i class="material-icons">more_horiz</i>
            <!--sup class="orange-text">*</sup-->
            <span>Категория</span>
          </h4>
          <tree-item data-item="$ctrl.data.category" data-data="categoryData" data-param="categoryParam" on-select-item="$ctrl.OnSelectCategory(item)" style000="border-bottom: 1px solid grey; display: block;"></tree-item>
        </div>
            
      </div> <!-- row -->

      <h4 class="bold">
        <i class="icon-rouble"></i>
        <span>Оплата</span>
      </h4>
      <div class="divider"></div>
      <div class="row">
        <div class="col s12 m6 l2">
          <h4>
            <span>Стоимость</span>
            <span class="fs8">руб</span>
          </h4>
          <div class="input-field" style="">
            <a ng-show="$ctrl.data['стоимость'].length"  ng-click=" $ctrl.data['стоимость']  = null; $ctrl.FormatNumeric('стоимость'); " href="javascript:" class="remove-siblings"  style="left: 0; position: absolute; top:0;">
              <i class="material-icons brown-text">cancel</i>
            </a>
            <input name="стоимость" type="text" class="right-align" ng-model="$ctrl.data['стоимость']" ng-change="$ctrl.FormatNumeric('стоимость')" placeholder="ставка/сумма">
            <!--a ng-show="$ctrl.tehComplete && $ctrl.tehComplete.length"  ng-click="$ctrl.ToggleTehList()" href="javascript:" class="prefix000"  style="right: 0; position: absolute; top:0;">
              <i class="material-icons">arrow_drop_down_circle</i>
            </a-->
          </div>
        </div>
        
        <div class="col s12 m6 l2">
            <!--тут уникод пробел( )-->
          <div class="input-field" style="">
            <a ng-hide="$ctrl.data['тип стоимости'] === undefined"  ng-click=" $ctrl.data['тип стоимости'] = null " href="javascript:" class="remove-siblings"  style="right: 1rem; position: absolute; top:0.3rem;">
              <i class="material-icons brown-text">cancel</i>
            </a>
            <div ng-repeat="p in payType" class="chip000" style000="margin: 0rem 1rem;">
              <input ng-model="$ctrl.data['тип стоимости']" ng-value="{{p.val}}" class="with-gap" name="тип стоимости" type="radio" ng-attr-id="{{'pay'+$index}}" ng-change="$ctrl.ChangePayType()" />
              <label for="pay{{$index}}">{{p.title}}</label>
            </div>
          </div>
        </div>
        
        <div ng-show000="$ctrl.data['тип стоимости'] " class="col s12 m6 l2">
          <h4 class="" ng-class="{'grey-text': $ctrl.data['тип стоимости'] === 0}"> 
            <i class="material-icons fs20">stop</i>
            <span>Факт </span>
            <span class="fs8">часов/км</span>
          </h4>
          <div class="input-field" style="">
            <a ng-show="$ctrl.data['факт'].length"  ng-click=" $ctrl.data['факт']  = null; $ctrl.FormatNumeric('факт'); " href="javascript:" class="remove-siblings"  style="left: 0; position: absolute; top:0;">
              <i class="material-icons brown-text">cancel</i>
            </a>
            <input name="факт" type="text" class="right-align" ng-model="$ctrl.data['факт']" ng-change="$ctrl.FormatNumeric('факт')" placeholder="часы/км" ng-disabled="$ctrl.data['тип стоимости'] === 0">
            <!--a ng-show="$ctrl.tehComplete && $ctrl.tehComplete.length"  ng-click="$ctrl.ToggleTehList()" href="javascript:" class="prefix000"  style="right: 0; position: absolute; top:0;">
              <i class="material-icons">arrow_drop_down_circle</i>
            </a-->
          </div>
        </div>
        
        <div ng-if000="$ctrl.data['стоимость'] && $ctrl.data['факт'] " class="col s12 m6 l2">
          <h4 class=""> 
            <!--i class="material-icons">add_box</i-->
            <span class="bold">Σ</span>
            <span>Сумма всего</span>
            <span class="fs8">руб</span>
          </h4>
          <div class="input-field" >
            <input name="сумма" type="text" class="right-align" style="" ng-model="$ctrl.data['сумма']" placeholder="стоимость*факт" ng-disabled="true">
          </div>
        </div>
        
        <div  class="col s12 m6 l2">
          
          <h4 class=""> 
            <i class="material-icons">today</i>
            <span>Дата получения документов</span>
          </h4>
          <div class="input-field" style="">
            <input name="дата получения док" type="text" class="datepicker"  data-value="{{ $ctrl.data['дата получения док'] }}" placeholder="фактическая"  style000="padding-left: 3rem; margin-left: 0px;">
          </div>
          
          <h4 class=""> 
            <i class="material-icons">today</i>
            <span>Дата оплаты по договору</span>
          </h4>
          <div class="input-field" style="">
            <input name="дата оплаты по договору" type="text" class="datepicker"  data-value="{{ $ctrl.data['дата оплаты по договору'] }}" placeholder="планируемая"  style000="padding-left: 3rem; margin-left: 0px;">
          </div>
        </div>
        
        <div class="col s12 m6 l2">
          <h4 class=""> 
            <span class="bold">№</span>
            <span>Документ оплаты</span>
          </h4>
          <div class="input-field" style="">
            <input name="док оплаты" type="text" class=""  ng-model="$ctrl.data['док оплаты']" placeholder="номер счета/фактуры"  style000="padding-left: 3rem; margin-left: 0px;">
          </div>
          
          <h4 class=""> 
            <i class="material-icons">today</i>
            <span>Дата оплаты</span>
          </h4>
          <div class="input-field" style="">
            <input name="дата оплаты" type="text" class="datepicker"  data-value="{{ $ctrl.data['дата оплаты'] }}" placeholder="фактическая"  style000="padding-left: 3rem; margin-left: 0px;">
          </div>
          
        </div>
        
        
        
      </div>
      
      
      <div class="input-field">
        <h4>
          <i class="material-icons">comment</i>
          <span>Описание заявки</span>
        </h4>
        <div class="divider"></div>
        <textarea ng-model="$ctrl.data['коммент']" class="materialize-textarea" style="font-size:1rem; padding:0;"></textarea>
      </div>
      
      <div class="row">
        <div class="col offset-l4 s12 m6 l4">
          <h4 class="" title="{{ $ctrl.data['дата2'] }}"> 
            <i class="material-icons">today</i>
            <span>Дата завершения работы (выгрузка)</span>
            <!--i class="material-icons">lock_outline</i-->
          </h4>
          <div class="input-field" style="" ng-if="$ctrl.data['дата2'] !== 0">
            <a ng-show="$ctrl.data['дата2']"  ng-click=" $ctrl.ClearDate('дата2') " href="javascript:" class="remove-siblings"  style="right: 0; position: absolute; top:0;">
              <i class="material-icons brown-text">cancel</i>
            </a>
            <input name="дата2" type="text" class="datepicker"  data-value="{{ $ctrl.data['дата2'] }}" placeholder="{{'фактическая'}}" ng-disabled="!$ctrl.Validate4Date2()" style000="padding-left: 3rem; margin-left: 0px;">
            <!--span class="grey-text right fs8" ng-show="!$ctrl.Validate4Date2()">заполни всю заявку</span-->
          </div>
        </div>
      
      </div>
      
      <div ng-show="$ctrl.error" class="red-text">{{ $ctrl.error }}</div>
      <div ng-show="$ctrl.cancelerHttp" ng-include=" 'progress/save' "></div>
    
    </div>
    <div class="card-action center">
      <a class="btn" ng-click="$ctrl.Save($ctrl.data)" href="javascript:" ng-disabled="!$ctrl.Validate($ctrl.data)">
        <i class="material-icons">save</i>
        <span>Сохранить</span>
      </a>
      <!--a ng-if="$ctrl.data.id" class="btn red" ng-click="$ctrl.Delete($ctrl.data)" href="javascript:">
        <i class="material-icons">delete_forever</i>
        <span>Удалить</span>
      </a-->
    </div>
    </div>
  <!--div>{{ $ctrl.data | json }}</div-->
  </div>


</div>