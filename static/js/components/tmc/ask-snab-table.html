
@@@ tmc/ask/snab/table

<!--div ng-if=" $ctrl.ready && $ctrl.project !==  $ctrl.param['проект/id'] " ng-init="$ctrl.$onInit()" ng-show="0"></div><!---  Наблюдать для обновления контекста -->

<!--div>{{ $ctrl.param | json }}</div-->

<div ng-hide="$ctrl.ready" ng-include=" 'progress/load' "></div>

<ul ng-if="$ctrl.tabsReady" class="tabs card000 tabs-transparent teal lighten-2" style="margin:0;" ng-init="$ctrl.DataOK()">
  <li ng-repeat="t in $ctrl.tabs" class="tab" ng-attr-id000="">
    <a ng-click="$ctrl.tab = t" href="javascript:" ng-class="{'active': t === $ctrl.tab}" class="" title="{{t}}">
      <i   class="material-icons">{{t.icon}}</i>
      <span>{{t.title}}</span>
      <span class="chip middle black-text" style="padding: 0.2rem 0.5rem;	display: inline;">{{$ctrl.data.filter($ctrl.FilterData, t).length}}</span>
    </a>
  </li>
</ul>

<!--div class="table-scroll-outer"><div class="table-scroll-inner"-->
<table ng-if="$ctrl.ready && $ctrl.tab === $ctrl.tabs[0]" class="striped highlight">
  <thead>
    <!--tr><th>#</th-->
    <th class="right-align000">
      <h4>
        <a href="javascript:" data-target="date-select">
          <!--i class="material-icons">today</i-->
          <span>Дата</span>
        </a>
      </h4>
      <div ng-if="$ctrl.param.table['дата1'].ready">
       <span ng-repeat="v in $ctrl.param.table['дата1']['формат'] track by $index" class="breadcrumb00 chip green-text">{{v}}</span>
      </div>
    </th>
    
    <th ng-if="$ctrl.param['объект'].id === 0">
      <h4>Объект</h4>
    
    </th>
    
    <!--th ng-if="$ctrl.param.move.id === 0 || $ctrl.param.move.id == 1" ng-class="{'light-green lighten-4': $ctrl.param.move.id === 0}">
      <h4><a href="javascript:" data-target="contragent-select" class="green-text text-darken-2">
        <i class="material-icons">business</i>
        <span>Контрагент</span>
      </a></h4>
      <div ng-if="$ctrl.param.table['контрагент'].ready && $ctrl.param.table['контрагент'].id">
       <span class="chip green-text">{{$ctrl.param.table['контрагент'].title}}</span>
      </div>
      
    </th-->
    
    <th style="width:40%;">
      <h4><a href="javascript:" data-target="nomen-select" class000="green-text text-darken-2">
        <!--i class="material-icons">business</i-->
        <span>Наименование</span>
      </a></h4>
      <div ng-if="$ctrl.param.table['номенклатура'].ready && $ctrl.param.table['номенклатура'].id">
       <span class="chip green-text">{{$ctrl.param.table['номенклатура'].title}}</span>
      </div>
      
    </th>
    
    <th>
      <h4>
        <!--i class="material-icons">more_horiz</i-->
        <span>Количество</span>
      </h4>
    </th>
    
    <!--th>
      <h4>
        <span>Ед</span>
      </h4>
    </th-->
    
    <th style="width:10%;">
      <h4>
        <!--i class="material-icons">message</i-->
        <span>Примечание</span>
      </h4>
    </th>
    <th class="center">
      <h4>Выбор</h4>
    </th>
    
    </tr>
  </thead>
  
  <tbody>
    
    <tr ng-repeat="it in $ctrl.data | filter: $ctrl.FilterData | orderBy : $ctrl.OrderByData : false"  ng-attr-id="{{it.id}}"  class="waves-effect00 waves-teal00" ng-class="{'selected': it['обработка']}" style000="cursor:pointer;" title="{{it | json}}">
      <!--td>
        <div ng-class="{'deep-orange-text text-darken-1': it._new}">{{$index+1}}<sup ng-show="it._new">*</sup></div>
      </td-->
      <td class="right-align00">{{it["дата1 формат"]}}</td>
      <td ng-if="$ctrl.param['объект'].id === 0">
        {{it['объект']}}
      </td>
      <td><span ng-repeat="n in it['номенклатура'] track by $index" class="breadcrumb teal-text"><span class="chip000 border000">{{n}}</span></span></td>
      <td>{{parseFloat(Util.numeric(it["количество"])).toLocaleString('ru-RU')}}</td>
      <!--td>{{it['ед']}}</td-->
      <td>
        <textarea ng-model="it['коммент']" ng-disabled="true" class="materialize-textarea fs8" style="font-size:0.8rem; padding:0;"></textarea>
      </td>
      <td>
        <div class="input-field center" style000="height: 2.1rem; padding: 0.25rem 0rem;">
          <input type="checkbox" ng-attr-id="{{it.id}}" ng-model="it['обработка']"  ng-change="$ctrl.Checked(it)" ng0000-click="$ctrl." ng000-checked="!!row['']" ng000-disabled="!row['']">
          <label for="{{it.id}}" ng-click="  $ctrl.Checked(it, true) "></label>
        </div>
      </td>
    </tr>
    
    <tr>
      <td colspan="{{$ctrl.param['объект'].id === 0 ? 7 : 6}}">
        <div class="center">
          <!--span>записей: {{ $ctrl.data.length }}</span-->
          <a ng-show="$ctrl.data.length >= 100" class="btn-flat" ng-click="$ctrl.LoadData(true)" href="javascript:">
            <i class="material-icons">file_download</i>
            Показать еще
          </a>
        </div>
        <div ng-show="$ctrl.cancelerHttp" ng-include=" 'progress/load' "></div>
      </td>
    
    </tr>
  
  </tbody>

</table>
<!--div>{{ $ctrl.dataOK | json }}</div-->
<!--/div></div-->

<div ng-if="$ctrl.ready && $ctrl.tab === $ctrl.tabs[1]" ng-init=" KEYS1 = $ctrl.Keys1DataOK() ">
<div ng-repeat="ID1 in KEYS1 | orderBy : $ctrl.OrderBy1DataOK : true" class="card" ng-init="data1 = $ctrl.Data1OK(ID1)" ng-attr-id="{{ data1[ 'тмц/снаб/id'] }}">
  <div class="card-content">
    <div class="row">
      <div class="col s7">
        <h4><a ng-click="$ctrl.Edit(ID1)" href="javascript:" class="btn-flat" style="text-transform: none;" ng-disabled="$ctrl.param['объект'].id !== 0">
          <span>{{ data1['дата отгрузки/формат'] }}, </span>
          <span>{{ data1['контрагент'] }}, </span>
          <span>{{ data1['адрес отгрузки'] }}</span>
          <span ng-if="$ctrl.param['объект'].id === 0" class="chip">{{ $ctrl.SumMoney(ID1).toLocaleString('ru-RU') }} руб</span>
          <span class="grey-text fs8">#{{ data1['id'] }}</span>
        </a></h4>
      </div>
      <div ng-show="data1['тмц/снаб/коммент']" class="col s5">
        <textarea ng-model="data1['тмц/снаб/коммент']" ng-disabled000="true" class="materialize-textarea" style="font-size:0.8rem; padding:0;"></textarea>
      </div>
    </div>
    <!--thead><tr>
        <th>
      </tr></thead-->
    <table class="striped" ng-init=" KEYS2 = $ctrl.Keys2DataOK(ID1)">
      <tbody>
        <tr ng-repeat="ID2 in KEYS2 | orderBy : $ctrl.OrderBy2DataOK : false" ng-init=" row = $ctrl.Data2OK(ID2) " title="{{ row|json }}">
          <td style="width: 7%;">
            {{ row["дата1 формат"] }}
          </td>
          <td style="width: 10%;">
            {{ row["объект"] }}
          </td>
          <td style="width: 40%;">
            <span ng-repeat="n in row['номенклатура'] track by $index" class="breadcrumb teal-text"><span class="chip000 border000">{{n}}</span></span>
          </td>
          <td style="width: 10%;">
            {{ parseFloat(Util.numeric(row["количество"])).toLocaleString('ru-RU') }}
          </td>
          <td class="right-align" style="width: 10%;">
            {{ row["цена"] }}
          </td>
          <td class="right-align" style="width: 10%;">
            {{ row["сумма"] }}
          </td>
          <td class="" style="width: 13%;">
            <textarea ng-model="row['коммент']" ng-disabled="true" class="materialize-textarea" style="font-size:0.8rem; padding:0;"></textarea>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

</div>
<div class="center">
  <!--span>записей: {{ $ctrl.data.length }}</span-->
  <a ng-show="$ctrl.data.length >= 100" class="btn-flat" ng-click="$ctrl.LoadData(true)" href="javascript:">
    <i class="material-icons">file_download</i>
    Показать еще
  </a>
</div>
</div>

<!-- Modal Structure -->
<div id="date-select" class="card modal" ng-if="$ctrl.param.table">
  <div class="modal-content">
    <h2 class="">Ограничить записи по датам</h2>
    <date-between data-param="$ctrl.param.table['дата1']"></date-between>
  </div>
  <div>{{$ctrl.param.table['дата1'] | json}}</div>
  <div class="modal-footer">
    <a ng-click="$ctrl.Cancel('дата1')" href="javascript:" class="modal-action modal-close  btn-flat">Отмена</a>
    <a ng-click="$ctrl.Send('дата1')" href="javascript:" class="modal-action modal-close  btn-flat teal-text">Готово</a>
    
  </div>
</div>

<!-- Modal Structure -->
<!--div id="sum-select" class="card modal" ng-if="$ctrl.param.table">
  <div class="modal-content">
    <h2 class="">Ограничить записи по сумме</h2>
    <div class="input-field">
      <h4>От</h4>
      <input type="text" class="" ng-model="$ctrl.param.table['сумма'].values[0]">
    </div>
    
    <div class="input-field">
      <h4>До</h4>
      <input type="text" class="" ng-model="$ctrl.param.table['сумма'].values[1]">
    </div>
  </div>
  <div class="modal-footer">
    <a ng-click="$ctrl.Cancel('сумма')" href="javascript:" class="modal-action modal-close  btn-flat">Отмена</a>
    <a ng-click="$ctrl.Send('сумма')" href="javascript:" class="modal-action modal-close  btn-flat teal-text">Готово</a>
    
  </div>
</div-->

<!-- Modal Structure -->
<div id="contragent-select" class="card modal" ng-if="$ctrl.param.table">
  <div class="modal-content">
    <h2 class="">Ограничить записи по контрагенту</h2>
    <contragent-item data-data="$ctrl.param.table['контрагент']"></contragent-item>
  </div>
  <div class="modal-footer">
    <a ng-click="$ctrl.Cancel('контрагент')" href="javascript:" class="modal-action modal-close  btn-flat">Отмена</a>
    <a ng-click="$ctrl.Send('контрагент')" href="javascript:" class="modal-action modal-close  btn-flat teal-text">Готово</a>
    
  </div>
</div>



