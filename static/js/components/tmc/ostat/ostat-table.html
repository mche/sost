@@@ tmc/ostat/table
<!--- текущие остатки --->

<div ng-hide="$c.ready" ng-include=" 'progress/load' "></div>

<div ng-if="$c.ready" class="z-depth-3 " ng-class=" $c.param.tableClass || 'purple  lighten-4 ' ">

<!-- фильтровать -->
<div class="row-000">
  <div class="input-field col-000-s1 chip" ng-init="ddd = $c.TitleDates()" title="{{ ddd | json }}">
    <input type="checkbox" ng-attr-id="крыжик-только-приходы" class="" ng-model=" $c['крыжик только приходы'] " ng-change="$c.RefreshTable()" ng-disabled=" !($c['крыжик текущие приходы'] || $c['крыжик предыдущие приходы']) " style="height: auto;"  >
    <label for="крыжик-только-приходы" class="before-green before-lighten-3 green-text text-darken-4 hover-shadow3d nowrap" ng-class="" title=" показать только строки с приходами "> </label>
    <input type="checkbox" ng-attr-id="крыжик-текущие-приходы" class="" ng-model=" $c['крыжик текущие приходы'] " ng-change="$c.ChangeChbPlus()" style="height: auto;"  >
    <label for="крыжик-текущие-приходы" class="before-green before-lighten-3 green-text text-darken-4 hover-shadow3d nowrap" ng-class="" title="период [{{ ddd[1] }}]--[{{ ddd[2] }}] ">Текущие приходы</label>
    <input type="checkbox" ng-attr-id="крыжик-предыдущие-приходы" class="" ng-model=" $c['крыжик предыдущие приходы'] " ng-change="$c.ChangeChbPlus()" style="height: auto;"  >
    <label for="крыжик-предыдущие-приходы" class="before-green before-lighten-3 green-text text-darken-4 hover-shadow3d nowrap" ng-class="" title="период [{{ ddd[0] }}]--[{{ ddd[1] }}] ">Предыдущие приходы</label>
  </div>
  
  
  <div class="input-field col-000-s1 chip">
    <input type="checkbox" ng-attr-id="крыжик-все-остатки" class="" ng-model=" $c['крыжик все остатки'] " ng-change="$c.RefreshTable()" style="height: auto;"  >
    <label for="крыжик-все-остатки" class="before-teal before-lighten-3 teal-text text-darken-3 hover-shadow3d nowrap" ng-class="">0 на остатке</label><!--&#8203; осторожно, тут пробел нулевлой ширины--->
  </div>
  
    <div class="input-field chip">
      <input type="text" ng-model="$c['фильтр наименования']" ng-change="$c.ChangeNomenFilter($event) " placeholder="фильтровать по наименованию" style="border: none; font-weight: normal;">
      <a ng-show=" $c['фильтр наименования'] " ng-click=" $c.ChangeNomenFilter(undefined, '') " href="javascript:" style="position: absolute; z-index: 1; right:0.7rem; top:0.5rem;">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 50" class="red-fill fill-darken-1" style="height: 1.5rem;"><use xlink:href="/fonts/icons.svg#left-clear-fill"></use></svg>
      </a>
      
    </div>
    
    <div class="chip" style="width:20rem;">
      <tree-item ng-init=" param = {'не добавлять новые позиции': true, placeholder: 'точно наименование'} " data-item=" $c.nomenTreeItem " data-data="$c['номенклатура']" data-param=" param " data-on-select-item=" $c.OnSelectNomenTreeItem(item) "></tree-item>
    </div>
  
  <!--div class="divider"></div-->

</div>

<div ng-show=" $c._refreshTable " ng-include=" 'progress/load' "></div>

<table ng-if=" !$c._refreshTable " ng-init="$c.InitTable()" class="highlight bordered striped animated slideInUp" ng-class=" $c.param.tableClass || 'purple  lighten-4 ' ">
<thead>
  <tr>
    <th style="width:1%;"></th><!--крыжики -->
    <th class="relative">

      <!--h4 class="fw500">Наименование</h4-->
      <div>
        <i class="material-icons">filter_list</i>
        <span class="chip">{{ $c['@номенклатура/id'].length }}</span> из <span class="chip">{{ $c['@номенклатура без фильтрации/id'].length }}</span>
      </div>
      
    </th>
    <th ng-repeat=" oid in $c['@объекты/id'] |  orderBy: $c.OrderByObject " ng-init=" o = $c['$объекты'][oid];" class="center vbottom teal-lighten-2" style="width:1%; padding-top: 0.5rem;">
      <h6 class="chip padd-0-02 iblock truncate blue-text text-darken-4 fw500" style="width: 4rem;" title="{{ o.name }}">
        <span ng-show="!$c.param['объект'] || !$c.param['объект'].id || $c.param['объект'].id != o.id ">{{ o.name }}</span>
        </h6>
        <a ng-hide-000="!$c.param['объект'].id" ng-if=" $c.ShowMoveBtn(oid) " ng-click="$c.NewMove(oid)" href="javascript:" class="btn-flat red lighten-3 red-text text-darken-3" style-000="position: absolute; z-index: 1; right:0;" title="в перемещение">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 26 26" style="height: 1.2rem;" class="red-fill fill-darken-3"><use xlink:href="/fonts/icons.svg#from-location"></use></svg>
          <!--span>Все в перемещение</span-->
        </a>
      <!--div>{{ o['$проект'].name }}</div-->
    </th>
  </tr>
</thead>
<tbody>
<!--tr ng-repeat="row in $c.data | orderBy: $c.OrderBy" ng-init="$c.InitRow(row)"| filter : $c.FilterByNomen -->
<tr  ng-repeat="nid in $c['@номенклатура/id'] | orderBy: $c.OrderByNomen" ng-init=" nomen = $c['$номенклатура'][nid]; ">
  <td class="">
    <div class="input-field center">
      <input type="checkbox" ng-attr-id="крыжик-{{ nid }}" class="" ng-model=" $c['крыжики номенклатуры'][nid] " style="height: auto;"  >
      <label for="крыжик-{{ nid }}" class="before-yellow before-lighten-3 teal-text text-darken-4 hover-shadow3d" ng-class="">&#8203;</label><!-- осторожно, тут пробел нулевлой ширины--->
    </div>
  </td>
  <td class=" ">
    
    <h5>
      <span ng-if=" nomen.parents_title && nomen.parents_title.length && nomen.parents_title[0] " ng-repeat="n in nomen.parents_title track by $index" class="breadcrumb">{{n}}</span>
      <span class="breadcrumb">{{ nomen.title }}</span>
      <span class="padd-0-05 grey-text fs8">#{{ nomen.id }}</span>
    </h5>
    
    <!--- строки приходов ---><!--ng-if-000=" ($c['крыжик текущие приходы'] || $c['крыжик предыдущие приходы']) && $c['$приходы'][nid] "-->
    <ul ng-if="$c['$приходы'][nid]['@_приходы'] && $c['$приходы'][nid]['@_приходы'].length"  class="collection-000 right-align" style="margin:0;">
      <li ng-repeat=" p in $c['$приходы'][nid]['@_приходы'] " class="collection-item-000 " ><span class="chip  green lighten-2" title="{{ p | json }}">{{ $c.FormatDate(p['дата']) }}</span></li>
    </ul>
    
  </td>
  <td ng-repeat=" oid in $c['@объекты/id'] |  orderBy: $c.OrderByObject " ng-init=" row = $c.InitRow($c.$data[oid][nid])" class="center" ng-class="{'vbottom': $c['$приходы'] && $c['$приходы'][nid] && $c['$приходы'][nid]['@приходы'] && $c['$приходы'][nid]['@приходы'].length }" >
    <div ng-if="row && row.hasOwnProperty('остаток')" ng-hide="!$c['крыжик все остатки'] && parseFloat(row['остаток']) == 0" title="{{ row['номенклатура'].parents_title.join('〉')+ '〉'+ row['номенклатура'].title }} | {{ row['объект'].name }}">
      <a ng-click="$c.ShowMoveTMC(row)" href="javascript:" class="fs12 bold hover-shadow3d-000 btn-flat" ng-class="{'red darken-2 white-text': parseFloat(row['остаток']) < 0, 'green-text text-darken-4': parseFloat(row['остаток']) > 0, 'grey-text': parseFloat(row['остаток']) == 0 }">
        {{ row['остаток'] }}
      </a>
    </div>
    
    <!--- строки приходов ---><!--ng-if-000=" ($c['крыжик текущие приходы'] || $c['крыжик предыдущие приходы']) && $c['$приходы'][nid] "-->
    <ul ng-if="$c['$приходы'][nid]['@_приходы'] && $c['$приходы'][nid]['@_приходы'].length"  class="collection-000" style="margin:0;">
      <li ng-repeat=" p in $c['$приходы'][nid]['@_приходы'] "  class="collection-item-000 center chip  " ng-class="{'transparent': p['объект/id'] != oid, 'green lighten-2': p['объект/id'] == oid, }"><span class="" title="{{ p['объект/id'] == oid && $c.TitlePlus(p) }}">{{ p['объект/id'] == oid ? '+'+p['количество'] : '&nbsp;' }}</span></li>
    </ul>
    
  </td>
  <!--td style="width:40%;">
    <span ng-show="!($c.param['объект'] && $c.param['объект'].id && $c.param['объект'].id == row['объект/id']) " class="right-align000 orange-text text-darken-4">{{ row['объект'].name }} ({{ row['объект']['$проект'].name }})</span>
  </td-->

</tr>

</tbody>
</table>


</div>

<!-- Modal Structure -->
<div id="move-detail" class="modal" style="max-height:94%; width:94%; top: 5%; " data-overlay-in="animated fade-in-05" data-overlay-out="animated  fade-out-05 " data-modal-in="animated zoomIn" data-modal-out="animated slideOutUp faster" >
  
  <div class="modal-content">
    <a href="javascript:" class="modal-action modal-close  btn-flat z-depth-1 white red-text right" style-000="position: absolute; z-index: 1; right:0;"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="red-fill" style="height: 1.5rem;"><use xlink:href="/fonts/icons.svg#cancel"></use></svg> Закрыть</a>
    <h2 class="row">Движение ТМЦ 
      <span class="" title="{{ $c.moveDetailTMC['номенклатура'] | json }}">
        <span ng-repeat="n in $c.moveDetailTMC['номенклатура'].parents_title track by $index" ng-hide="!n" class="breadcrumb brown-text-darken-3 fw500"><span class="chip shadow-inset-10">{{n}}</span></span>
        <span class="breadcrumb brown-text-darken-3 fw500"><span class="chip shadow-inset-10 ">{{ $c.moveDetailTMC['номенклатура'].title }}</span></span>
      </span>
    </h2>
    <h2 class="row">По объекту
    
      <span class="chip z-depth-1 blue-text-darken-3 shadow-inset-10 fw500">
        {{ $c.moveDetailTMC['объект'].name }} ({{ $c.moveDetailTMC['объект']['$проект'].name }})
      </span>
    </h2>
    
    <div ng-if="$c.moveDetailTMC" ng-hide="$c.moveDetailTMC['движение']" ng-include=" 'progress/load' "></div>
    
    <table ng-if="$c.moveDetailTMC['движение']" class="striped bordered z-depth-3 teal lighten-4">
    <thead class="grey lighten-2">
      <tr>
        <th style="width:1%;"><h4 class="fw500 black-text000">Дата</h4></th>
        <th class="green lighten-3" style="width:1%;"><h4 class="green-text text-darken-3 center nowrap fw500"><i class="material-icons">add_circle_outline</i>Поступило</h4></th>
        <th class="green lighten-3"><h4 class="green-text text-darken-3 fw500"><i class="icon-left fs10"></i>Откуда</h4></th>
        <th class="red lighten-3" style="width:1%;"><h4 class="red-text text-darken-3  nowrap fw500"><i class="material-icons">remove_circle_outline</i>Перемещено</h4></th>
        <th class="red lighten-3"><h4 class="red-text text-darken-3 fw500"><i class="icon-left before-rotate180 fs10"></i>Куда</h4></th>
        <th><h4 class="fw500 black-text000">По заявке</h4></th>
        <!--th></th-->
      </tr>
    </thead>
    
    <tbody>
      <tr ng-repeat="row in $c.moveDetailTMC['движение']" ng-init="$c.InitRow(row)" ng-class="{'blue lighten-3': row['инвентаризация'], }">
        <td class=" relative vtop">
          <span class="nowrap" title="дата приема">
            <span class="fs8"> {{ row['$дата']['день нед'] }} </span>    <span class="bold"> {{ row['$дата']['day'] }} </span>   <span class="fs8"> {{ row['$дата']['мес'] }} </span>
          </span>
          <span class="chip padd-0-05 fs8 nowrap" title="повесил">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 50" class="black-fill" style="height: 0.7rem;"><use xlink:href="/fonts/icons.svg#person"></use></svg>
            {{ row['$профиль'].names.join(' ') }}
          </span>
          <span class="grey-text fs7" style="position: absolute; z-index: 1; top:0; right:0;" title="ид тмц-движения">#{{ row.id }}</span>
        </td>
        <td class=" right-align green lighten-4" style000="width:5%;">
          <div ng-if=" row['приход'] || row['инвентаризация'] ">
            <span class=" text-darken-3  fs14 bold" ng-class="{'blue-text': row['инвентаризация'], 'green-text': !row['инвентаризация'],}">{{ row['количество'] }}</span><!---/принято --->             <span class="fs8 grey-text left">{{ row['цена'] }}</span>
          </div>
        </td>
        
        <!-- откуда поступило --> 
        <td>
          <h5 ng-show="  row['приход'] " class="chip transparent  green-text" ng-init=" kgo = row['@грузоотправители'] && row['@грузоотправители'].length ">
            <i class="icon-left fs10"></i>
            <span ng-if-000="!row['$объект2'] && !row['$с объекта']" ng-if=" kgo " ng-repeat="k in row['@грузоотправители']" class="middle leaf green darken-3 white-text fw500" ng-class="{}">{{ k.title }}</span><!-- {{ k['проект0000'] }}-->
            <span ng-if="row['$проще/строка поставщика']" class="middle leaf maroon white-text fw500" title="простая поставка">{{ row['$проще/строка поставщика']['$контрагент'].title }} <span class="chip shadow-inset-10 maroon-text fw500">{{ row['$проще/строка поставщика']['количество'] }}</span></span>
            <!--span ng-if="!row['$объект2'] && !!row['$с объекта']" class="leaf blue darken-3 white-text middle fw500">★ {{ row['$с объекта'].name }} ({{ row['$с объекта']['$проект'].name }})</span-->
            <i ng-show="row['$проще/строка поставщика']" class="icon-left before-rotate180 fs10"></i>
            <span ng-if="!!row['$объект2']" class="middle fw500" ng-class="{'blue-text':row['$проще/строка поставщика'], 'red-text right': 0 && kgo, 'chip blue-text-darken-3': !row['$проще/строка поставщика'], }">
              <!--i ng-show="kgo" class="icon-left before-rotate180 fs10"></i-->
              <span>★ {{ row['$объект2'].name }}</span><!-- ({{ row['$объект2']['$проект'].name }}) -->
              <!-- просто разница на простой поставке уходит на заявку -->
              <span ng-if="row['$проще/строка поставщика']" class="chip shadow-inset-10 fw500" title="списано на этот объект по заявке простой поставке">{{ row['$проще/строка поставщика']['количество'] - row['количество'] }}</span>
            </span>
          </h5>
          
          <h4 ng-if=" row['инвентаризация'] " class="chip transparent white-text fw500">
            <i class="icon-left before-rotate90left fs10"></i>
            <span>инвентаризация</span>
          </h4>
          
          <div ng-show=" row['$тмц'] && row['$тмц']['коммент'] " class="chip fs8 truncate" style="height: 2rem; max-width:50%;" title="{{ row['$тмц']['коммент'] }}">
            {{ row['$тмц']['коммент'] }}
          </div>
        
        </td>
        
        <td class="right-align red lighten-4" style000="width:5%;">
          <div ng-if="row['расход'] || row['списание']">
            <span  class="red-text text-darken-3 fs14 bold">{{ -row['количество'] }}</span>             <span class="fs8 grey-text left">{{ row['цена'] }}</span>
          </div>
        </td>
        
        <!-- куда перемещено --> 
        <td>
          <h5 ng-show="row['расход'] || row['списание'] " class="red-text">
            <i class="icon-left fs10  before-rotate180"></i>
            <span ng-if="row['объект2/id'] != 0">
              <span ng-if=" !row['$объект2'] && !row['$на объект']" ng-repeat="k in row['@грузоотправители']" class="middle leaf green white-text fw500">{{ k.title }} {{ k['проект000'] }}</span>
              <span ng-if=" !row['$объект2'] && !!row['$на объект']" class="chip blue-text-darken-3  middle fw500">★ {{ row['$на объект'].name }} ({{ row['$на объект']['$проект'].name }})</span>
              <span ng-if=" !!row['$объект2']" class="chip blue-text-darken-3 middle fw500">★ {{ row['$объект2'].name }} ({{ row['$объект2']['$проект'].name }})</span>
            </span>
            <span ng-if="row['объект2/id'] == 0 ||  row['списание'] ">списано</span>
            <!--span ng-if="!row['$объект2'] && !!row['$с объекта']" class="orange-text text-darken-3 middle">{{ row['$с объекта'].name }} </span>
            <span ng-if="!!row['$объект2']" class="orange-text text-darken-3 middle">{{ row['$объект2'].name }} ({{ row['$объект2']['$проект'].name }})</span--->
          </h5>
        
        </td>
        
        <!--- кому-->
        <!--td>
          <i class="icon-left" ng-class="{'before-rotate180': !!row['$объект2'], 'green-text': row['движение'] == 'приход', 'red-text ': row['движение'] == 'расход' }"></i>
          <span ng-if="!row['$объект2']" ng-repeat="k in row['@грузоотправители']" class="middle">{{ k.title }} {{ k['проект000'] }}</span>
          <span ng-if="!row['$объект2'] && !!row['$с объекта']" class="orange-text text-darken-3 middle">{{ row['$с объекта'].name }}</span>
          <span ng-if="!!row['$объект2']" class="orange-text text-darken-3 middle">{{ row['$объект2'].name }} ({{ row['$объект2']['$проект'].name }})</span>
        </td-->
        
        <!--- от кого-->
        <!--td>
          <i class="icon-left" ng-class="{'before-rotate180-000': !!row['$объект2'], 'green-text': row['движение'] == 'приход', 'red-text': row['движение'] == 'расход' }"></i>
          <span ng-if="!!row['$объект2']" ng-repeat="k in row['@грузоотправители']" class="middle">{{ k.title }} {{ k['проект000'] }}</span>
        </td-->
        
        <td>
          <div ng-if="row['$тмц/заявка']">
            <div>{{ row['$тмц/заявка']['наименование'] }}</div>
            <div ng-show=" row['$тмц/заявка']['коммент'] " class="fs8 truncate" style="height:2rem;">{{ row['$тмц/заявка']['коммент'] }}</div>
            <div class="fs7 grey-text right-align" title="{{ row['$тмц/заявка'] | json }}">#{{ row['$тмц/заявка'].id }}</div>
          </div>
        </td>
        
      </tr>
    </tbody></table>
    
  </div>
  <!---div class="modal-footer">
    <a ng-click="$c.Cancel('контрагент')" href="javascript:" class="modal-action modal-close  btn-flat">Отмена</a>
    <a ng-click="$c.Send('контрагент')" href="javascript:" class="modal-action modal-close  btn-flat teal-text">Готово</a>
    
  </div--->
</div>