@@@ tmc/ask/table

<div ng-show="!$c.ready || $c.refreshTable" ng-include=" 'progress/load' "></div>

<!--tmc-ask-form ng-if="$c.ready"  data-param="$c.param"></tmc-ask-form-->

<div ng-if="$c.ready && !$c.refreshTable" class=" z-depth-3 animated slideInUp" style="/*max-height: 50vh; overflow-y: auto;*/">

<!--h3 ng-show="$c.param.title" class="center border-bottom" ng-class=" $c.param.theadClass  ">{{ $c.param.title }}</h3-->

<table ng-init=" $c.InitTable() " class="top000 striped bordered " ng-class=" $c.param.theadClass " ng-class-000="{'highlight-maroon-lighten-4': !!$c.param['список простых закупок'], 'highlight-orange-lighten-4': !!$c.param['в закупку']}">
  <thead><tr>
    <th class="center" style="width:1%;">
      <a href="javascript:" data-target="date1-select" class="hover-shadow3d">
        <h4 class="fw500">
          <span>На дату</span>
        </h4>
        <div ng-if="$c.where['дата1'].ready">
         <span ng-repeat="v in $c.where['дата1']['формат'] track by $index" class="breadcrumb00 chip green-text">{{v}}</span>
        </div>
      </a>
      <div class="left-align">
        <a ng-click=" $c.where['дата1']['обратно сортировать'] = $c['обратно сортировать'] = !$c.where['дата1']['обратно сортировать'] " class="btn-flat hover-shadow3d" href="javascript:" title="порядок сортировки"><i class="material-icons fs20" ng-class="{'flip180': !$c.where['дата1']['обратно сортировать']}">sort</i></a>
      </div>
    </th>
    
    <th class="center" style="min-width:50%;">
      <a href="javascript:" data-target="nomen-select" class="hover-shadow3d">
        <h4 class="fw500">
          <!--i class="material-icons">business</i-->
          <span>Наименование</span>
        </h4>
        <div ng-if="$c.where['наименование'].ready && $c.where['наименование'].title" class="chip padd-0-05">
            <svg  xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="maroon-fill" style="height: 1.2rem;" ng-include=" 'svg/filter' " />
            <span class=" maroon-text maroon-000-lighten-5">{{$c.where['наименование'].title}}</span>
        </div>
      </a>
      <div ng-show="$c.param['обработать номенклатуру'] " class="purple-text text-darken-3">запрос остатков</div>
    </th>
    
    <th class="center" style="width:1%;">
      <h4 class="fw500">
        <!--i class="material-icons">more_horiz</i-->
        <span class="nowrap">Кол-во</span>
        <span ng-hide=" !$c.param['список простых закупок'] "><br>заявки</span>
      </h4>
      <!--div ng-show=" !$c.param['список простых закупок'] "><span class="bold">еще</span> <span class="chip grey-text">всего</span> </div-->
      
    </th>
    
    <th style="width:2%;">
      <h4 class="fw500">
        <span>Ед</span>
      </h4>
    </th>
    
    <!--th ng-if="$c.param['объект'].id === 0" class="center" style="width:20%;">
      <h4 class="fw500">На объект, заказал</h4>
    
    </th-->
    
    <th class="center" style="min-width:20%;">
      <h4 class="fw500">
        <!--i class="material-icons">message</i-->
        <span>Примечание</span>
      </h4>
    </th>
    
    <th ng-if=" !!$c.param['в закупку'] && !$c.param['список простых закупок'] " class="center vbottom" style="width:1%;">
      <h5 class="fw500"><i class="icon icon-star fs20"></i> закупка</h5>
    </th>
    
    <!--th ng-if=" !!$c.param['в закупку'] && !$c.param['список простых закупок'] " class="center vbottom" style="width:1%;">
      <h5 class="fw500 maroon-text text-darken-3" title="простая закупка">
        <i class="icon icon-ok-circle fs20"></i>
        проще
      </h5>
    </th-->
    
    <!--th ng-if=" !!$c.param['в перемещение'] && !$c.param['список простых закупок'] " class="center vbottom" style="width:1%;">
      <h5 class="fw500 red-text text-darken-3" title="простая поставка">
        <svg  xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 50" class="rotate90left red-fill fill-darken-3" style="height: 1.5rem;"><use xlink:href="/fonts/icons.svg#2arrows-180vert"></use></svg>
        перемещение</h5>
    </th-->
    
    <th ng-if=" !!$c.param['список простых закупок'] " class="vbottom" style="min-width:25%;">
      <h4 class="fw500 maroon-text text-darken-3" title="сразу списание">Простая закупка</h4>
    </th>

    
    </tr></thead>
  
  <tbody ng-class-000=" $c.param.tbodyClass " class=""><!-- | filter: $c.FilterData | orderBy: $c.OrderByData : !!$c.param['список простых закупок'] -->
    <tr  ng-repeat="ask in $c.dataFiltered | orderBy: $c.OrderByData : $c['обратно сортировать'] " ng-init="$c.InitRow(ask)"  ng-attr-id="{{ask.id}}" class="relative" ng-class="{'selected': ask['обработка'] || it === $c.param.edit || ask._edit}" ng-style-000="1 ? {'cursor': 'pointer'} : {}" title000="{000{it | json}}">
      <td class="right-align nowrap">
          <span class="fs8" title="требуется на {{ ask['дата1 краткий формат'] || ask['дата1'] }}"><span class=""> {{ ask['$дата1']['день нед'] }} </span>    <span class="bold"> {{ ask['$дата1']['day'] }} </span>   <span class="fs8"> {{ ask['$дата1']['мес'] }} </span> </span>
        <br ng-if="$c.param['объект'].id === 0 || $c.param['список простых закупок'] || ask['номенклатура/id']">
        <span class="fs8 grey-text chip" title="заявка записана"><span class=""> {{ ask['$ts']['день нед'] }} </span>    <span class=""> {{ ask['$ts']['day'] }} </span>   <span class=""> {{ ask['$ts']['мес'] }} </span></span>
      </td>

      <td class="right-align-000 padd-05">
        
          <h5 ng-hide-000="ask['$номенклатура']" class="fw500">
            <a ng-click="$c.ClickAsk(ask)" ng-click-000="ask._edit = true;" href="javascript:" class="hover-shadow3d">
              <span ng-class-000="{'fs8 grey-text-000': !!ask['номенклатура/id'] }">{{ ask['наименование'] }}<br ng-if="!!ask['номенклатура/id']"></span><!-- вместо позиции номенклатуры -->
              <span ng-if=" !ask['$номенклатура'] && ask['номенклатура'] && ask['номенклатура'].pop " ng-repeat="n in ask['номенклатура'] track by $index" class="breadcrumb brown-text"><span class="chip shadow-inset-10 padd-0-05-000 border000">{{n}}</span></span>
              
            </a>
          </h5>
          
          <!--- когда $c.param['обработать номенклатуру'] --->
          <div ng-if=" ask['$номенклатура'] || (ask['@тмц/резервы остатков'] && ask['@тмц/резервы остатков'].length) ">
            <tmc-ask-nomen-ost data-param=" $c.param "  data-ask=" ask "></tmc-ask-nomen-ost>
          </div>
          
          <!--- когда подгружен модуль 'ТМЦ/заявки/ответ по резерву остатка' (не заглушка) --->
          <div ng-if=" ask['@тмц/резервы остатков'] && ask['@тмц/резервы остатков'].length " class="right">
            <tmc-ask-ost-confirm data-param=" $c.param " data-ask=" ask "></tmc-ask-ost-confirm>
          </div>
          
        
          <div ng-if="ask._edit" class="absolute left-align" style="left: 0; /*top: 5rem;*/ z-index: 1; width:100%;">
            <tmc-ask-form data-param="$c.param" data-data="ask"></tmc-ask-form>
          </div>
          
      </td>
      <td class="center left-align-000 bold fs14">
        <!--span class="nowrap">{{  parseFloat(Util.numeric(ask["количество"])).toLocaleString('ru-RU')  }}</span>
        <span ng-hide="!ask['тмц/количество']" class="nowrap">- {{  parseFloat(Util.numeric(ask["тмц/количество"])).toLocaleString('ru-RU')  }} = {{  (parseFloat(Util.numeric(ask["количество"])) - parseFloat(Util.numeric(ask["тмц/количество"]))).toLocaleString('ru-RU')  }}</span-->
        <div ng-if=" !ask['@тмц/строки простой поставки'].length " class="">
          <span ng-hide="!ask['заявка/количество/остаток'] || ask['заявка/количество/остаток'] == parseFloat(Util.numeric(ask['количество']))" class="bold">{{ ask['заявка/количество/остаток'].toLocaleString('ru-RU') }}</span>
          <span ng-class="{'grey-text fs8 chip': !!ask['заявка/количество/остаток'] && ask['заявка/количество/остаток'] != parseFloat(Util.numeric(ask['количество'])), 'bold': !ask['заявка/количество/остаток'] || ask['заявка/количество/остаток'] == parseFloat(Util.numeric(ask['количество']))}">{{ parseFloat(Util.numeric(ask['количество'])).toLocaleString('ru-RU') }}</span>
        </div>
        
        <div ng-if=" ask['@тмц/строки простой поставки'].length " class="">
          {{ parseFloat(Util.numeric(ask['количество'])).toLocaleString('ru-RU') }}
        </div>
        
      </td>
      
      <td>{{ask['ед']}}</td>
      
      
      
      <td class="relative vtop-000">
        <!--textarea ng-hide="!ask['коммент']" ng-model="ask['коммент']" ng-disabled="true" class="materialize-textarea fs8" style="font-size:0.8rem; padding:0;"></textarea--->
        <div class="fs8 grey-text000">{{ ask['коммент'] }}</div>
        
        <div ng-if="$c.param['объект'].id === 0 || $c.param['объект'].id != ask['объект/id'] || (ask['@тмц/резервы остатков'] && ask['@тмц/резервы остатков'].length)">
          <h5 class="chip blue-text text-darken-4 fw500">
            <!--i class="icon icon-star fs10"></i-->
            <svg  xmlns="http://www.w3.org/2000/svg" viewBox="0 0 26 26" class="blue-fill fill-darken-4" style="height: 1.2rem;"><use xlink:href="/fonts/icons.svg#to-location" /></svg>
            <span>★ {{ask['объект']}}</span>
          </h5>
          <div class="chip padd-0-05 right">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 50" class=""  style="height: 1rem;"><use xlink:href="/fonts/icons.svg#person" /></svg>
            <span class="truncate nowrap iblock  fs8 " style="width: 7rem;">{{ ask['$профиль заказчика'].names.join(' ') }}</span>
          </div>
        </div>
        
        <div class="fs7 grey-text " style="position: absolute; z-index: -1; right:0; bottom:0;" title="ид заявки">#{{ ask.id }}</div>
      </td>
      
      <!-- крыжик в закупку -->
      <td ng-if="!!$c.param['в закупку'] && !$c.param['список простых закупок'] "><!---  !ask['@тмц/строки простой поставки'].length -->
        <div ng-if-000=" ask['количество/докупить'] || ask['количество/докупить'] == null " class="input-field center">
          <input type="checkbox" ng-attr-id="chb-{{ask.id}}" ng-model="ask['обработка']"  ng-change="$c.Checked(ask)" ng0000-click="$c." ng000-checked="!!row['']" ng-disabled=" !(ask['количество/докупить'] || ask['количество/докупить'] == null) ">
          <label for="chb-{{ask.id}}" ng-click-000="  $c.Checked(ask, true) " class="chb-yellow-lighten-4 teal-text text-darken-3">&#8203;</label></label><!-- осторожно, тут пробел нулевлой ширины--->
        </div>
      </td>
      
      <!-- крыжик в простую поставку -->
      <!---td ng-if=" !!$c.param['в закупку'] && !$c.param['список простых закупок'] " ng-init=" easy = ask['$простая обработка заявки'] " >
        <div class="input-field center">
          <input type="checkbox" ng-attr-id="chb-easy-{{ask.id}}" ng-model="easy._edit"  ng-change000="$c.CheckedEasy(easy)" ng0000-click="$c." ng000-checked="!!row['']" ng-disabled=" !(ask['количество/докупить'] || ask['количество/докупить'] == null) ">
          <label for="chb-easy-{{ask.id}}" ng-click000="  $c.CheckedEasy(easy, true) " class="chb-maroon-lighten-5 maroon-text text-darken-3" title="простая поставка без подтвердений">&#8203;</label></label><!-- осторожно, тут пробел нулевлой ширины->
        </div>
        

        
      </td--->
      
      <!-- крыжик в перемещение -->
      <!--td ng-if=" !!$c.param['в перемещение'] && !$c.param['список простых закупок'] ">
      <div class="input-field center">
          <input type="checkbox" ng-attr-id="chb-move-{{ask.id}}" ng-model="ask['в перемещение']"  ng-change="$c.CheckedMove(ask)">
          <label for="chb-move-{{ask.id}}" ng-click="  $c.CheckedMove(ask, true) " class="chb-red-lighten-3 red-text text-darken-4">&#8203;</label></label><!-- осторожно, тут пробел нулевлой ширины>
        </div>
      </td-->
      
      <!-- колонка отображения простой поставки -->
      <td ng-if="!!$c.param['список простых закупок'] " ng-init=" easy = ask['$простая обработка заявки'] " class="vtop-000">
        <div ng-show="easy['$строка тмц/поставщик']['количество']">
          <h5 class="center000 maroon-text" title000="тмц #{{ easy['$строка тмц/поставщик'].id }}">
            <span  class="leaf maroon white-text left left-align fw500"><i class="icon-left fs10"></i> <span ng-if="easy['$строка тмц/поставщик']['$контрагент']"> {{ easy['$строка тмц/поставщик']['$контрагент'].title }}</span></span>
            <a ng-click=" easy._edit = !easy._edit " href="javascript:" class="hover-shadow3d chip shadow-inset-10 center bold maroon-text" style="min-width:3rem;" title="изменить простую поставку">{{ easy['$строка тмц/поставщик']['количество'] }}</a>
            <span class="nowrap clearfix">
              <span class="chip padd-0-05 fs8">{{ easy['$строка тмц/поставщик']['$ts']['день нед'] }} {{  easy['$строка тмц/поставщик']['$ts']['day'] }} {{ easy['$строка тмц/поставщик']['$ts']['мес'] }}</span>
              <span class="chip padd-0-05 fs8"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 50" class="maroon-fill" style="height: 1rem;"><use xlink:href="/fonts/icons.svg#person"></use></svg> {{ easy['$строка тмц/поставщик']['$снабженец'].names.join(' ') }}</span>
              <span class="fs7 grey-text" style-0000="position: absolute; z-index: -1; right:0; bottom:0;" title="{{ easy['$строка тмц/поставщик'] | json }}">#{{ easy['$строка тмц/поставщик'].id }}</span>
            </span>
          </h5>
        </div>
        
        <!--- база отдала на простой поставке--->
        <div ng-show="easy['$строка тмц/с базы']['количество']">
          <h5 class="center000 red-text text-darken-2" title000="тмц #{{ easy['$строка тмц/с базы'].id }}">
            <span class="leaf red darken-3 white-text left left-align fw500"><i class="icon-left fs10"></i> ★ {{ easy['$строка тмц/с базы']['$объект'].name }}</span>
            
            <a ng-click=" easy._edit = !easy._edit " href="javascript:" class="hover-shadow3d chip shadow-inset-10 bold red-text text-darken-2" style="min-width:3rem;"><i class="material-icons ">remove_circle_outline</i>{{ easy['$строка тмц/с базы']['количество'] }}</a>
            <span class="nowrap clearfix">
              <span class="chip padd-0-05 fs8">{{ easy['$строка тмц/с базы']['$ts']['день нед'] }} {{  easy['$строка тмц/с базы']['$ts']['day'] }} {{ easy['$строка тмц/с базы']['$ts']['мес'] }}</span>
              <span ng-show="!easy['$строка тмц/поставщик']['количество']" class="chip padd-0-05 fs8"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 50" class="red-fill fill-darken-2" style="height: 1rem;"><use xlink:href="/fonts/icons.svg#person"></use></svg> {{ easy['$строка тмц/с базы']['$снабженец'].names.join(' ') }}</span>
              <span class="fs7 grey-text" style-0000="position: absolute; z-index: -1; right:0; bottom:0;" title="{{ easy['$строка тмц/с базы'] | json }}">#{{ easy['$строка тмц/с базы'].id }}</span>
            </span>
          </h5>
        </div>
        
        <!--- база приняла на простой поставке--->
        <div ng-show="easy['$строка тмц/на базу']['количество']">
          <h5 class="center000 green-text text-darken-4" title="тмц #{{ easy['$строка тмц/на базу'].id }}">
            <span class="leaf green darken-4 white-text left left-align fw500"><i class="icon-left fs10 before-rotate90right"></i> ★ {{ easy['$строка тмц/на базу']['$объект'].name }}</span>
            
            <a ng-click=" easy._edit = !easy._edit " href="javascript:" class="hover-shadow3d chip shadow-inset-10 bold green-text text-darken-4" style="min-width:3rem;"><i class="material-icons ">add_circle_outline</i>{{ easy['$строка тмц/на базу']['количество'] }}</a>
            
            <span class="fs7 grey-text" style-0000="position: absolute; z-index: -1; right:0; bottom:0;" title="{{ easy['$строка тмц/на базу'] | json }}">#{{ easy['$строка тмц/на базу'].id }}</span>
            
          </h5>
        </div>
        
        <!--div ng-if="!!$c.param['в закупку']" class="center" ng-style=" easy._edit && {'visibility':'hidden'} ">
          <a class="btn-flat maroon-text" ng-click=" easy._edit = !easy._edit " href="javascript:" title="изменить простую поставку"><i class="icon icon-ok-circle"></i></a>
        </div-->
        
        
        <!---строка  формы простой обработки -->
        <div ng-if="easy._edit" class="absolute" style="left: 0; /*top: 5rem;*/ z-index: 1; width:100%;">
          <tmc-snab-form-easy data-data=" easy " data-ask=" ask "></tmc-snab-form-easy>
        </div>
        
      </td>
    </tr>
  
  </tbody>

</table>

</div>

<div ng-show="!$c.ready || $c.cancelerHttp" ng-include=" 'progress/load' "></div>
<div ng-hide="$c.cancelerHttp" class="center">
    <span>записей: {{ $c.dataFiltered.length }}</span>
    <a ng-show="$c.dataFiltered.length >= 100" class="btn-flat z-depth-1" ng-click="$c.LoadData({'$Список':{'append': 1}, })" href="javascript:">
      <i class="material-icons">file_download</i>
      Показать еще записи
    </a>
</div>

<!-- Modal Structure -->
<div id="nomen-select" class="modal"  data-overlay-in="animated fade-in-05" data-overlay-out="animated  fade-out-05 fast" data-modal-in="animated slideInDown" data-modal-out="animated slideOutUp"  style="top:5%;">
  <div class="modal-content input-field">
    <a ng-click="$c.CancelWhere('наименование')" href="javascript:" class="right modal-action modal-close red-text btn-flat z-depth-1">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="red-fill fill-lighten-3" style="height: 1.5rem;"><use xlink:href="/fonts/icons.svg#cancel"></use></svg>
      Отмена
    </a>
    <h2 class="">Фильтровать по фрагменту строки наименования</h2>
    <input name="nomen-select" type="text" ng-model="$c.where['наименование'].title" />
  </div>
  <div class="modal-footer center">
    <a ng-click="$c.SendWhere('наименование')" href="javascript:" class="modal-action modal-close  btn-flat z-depth-1 green-text" style="float:none;">Готово</a>
  </div>
</div>